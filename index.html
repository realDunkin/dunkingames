<!DOCTYPE html>
  <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Home - Dunkin's Games</title>
      <link rel="shortcut icon" type="image/png" href="favicon.png">
  </head>
  <style>
    .Fantasy {
      font-family: "Fantasy", Helvetica, sans-serif;
    }
    tr {
      background-color: #a7d39e;
    }
    tr:hover {
      background-color: #98f7a8;
    }
  </style>
  <body background="background.png">
    <div id="MainText" class="Fantasy">
      <center>
        <p style="font-size: 32px;"><strong>Dunkin's Games</strong></p>
        <p style="font-size: 24px;"><strong>No Ads, No Lag! (Hopefully...)</strong></p>
      </center>
    </div>
    <div id="Sort" class="Fantasy">
      <center>
        <input type="text" id="searchBox" onchange="makeList()"></input>
        <br>
        <select id="listSort" size="1"  onchange="makeList()">
          <option value="New-Old">Sort By: Newest To Oldest</option>
          <option value="Old-New">Sort By: Oldest To Newest</option>
          <option value="A-Z">Sort By: A To Z</option>
          <option value="Z-A">Sort By: Z To A</option>
        </select>
        <br><br>
      </center>
    </div>
    <div id="ChartBody" class="Fantasy">
      <center>
        <table style="border-collapse: collapse; width: 75%; height: 85px;" border="10">
          <tbody id="DaChart">
          </tbody>
        </table>
      </center>
      <script>
        function clearList(){
          document.getElementById("DaChart").innerHTML = "";
        }
        function matchSearch(data){
          var jsonData = Object.assign({}, data, {});
          console.log("The Starting Data:");
          console.log(jsonData)
          var max = data.games.length;
          var removed = 0;
          searchValue = document.getElementById("searchBox").value.toLowerCase();
          if(searchValue != ""){
            for (let index = 0; index < data.games.length; index++) {
              if (data.games[index].name.toLowerCase().includes(searchValue) === false) {
                  var dataName = data.games[index].name.toLowerCase()
                  console.log(dataName + " Does Not Match " + searchValue + ", Terminating From Clone");
                  for (let index2 = 0; index2 < jsonData.games.length; index2++) {
                    console.log("Clone Current Length Is: " + jsonData.games.length + ", Matching Clone Index #" + index2);
                    if (jsonData.games[index2].name.toLowerCase() === dataName){
                      console.log("Found: " + dataName + ", Clone Length Is Now: " + jsonData.games.length);
                      delete jsonData.games[index2];
                      removed += 1;
                      break;
                    }
                  }
              }
            }
          }
          console.log("Filtered For: " + searchValue + " | Total Before: " + max + " | Total After: " + (max - removed) + " | Total Removed: " + removed);
          return jsonData;
        }
        function sortByNewOld(a, b) {
          if (a.id > b.id) {
            return -1;
          }
          if (a.id < b.id) {
            return 1;
          }
          return 0;
        }
        function sortByOldNew(a, b) {
          if (a.id < b.id) {
            return -1;
          }
          if (a.id > b.id) {
            return 1;
          }
          return 0;
        }
        function sortByAZ(a, b) {
          if (a.name < b.name) {
            return -1;
          }
          if (a.name > b.name) {
            return 1;
          }
          return 0;
        }
        function sortByZA(a, b) {
          if (a.name > b.name) {
            return -1;
          }
          if (a.name < b.name) {
            return 1;
          }
          return 0;
        }
        function makeList(){
          clearList();
          fetch("gameData.json").then(response => response.json()).then(data => {
                  sortValue = document.getElementById("listSort").value
                  switch (sortValue) {
                    case "New-Old":
                      data.games.sort(sortByNewOld);
                      console.log("Sorted By: Newest To Oldest");
                      break;
                    case "Old-New":
                      data.games.sort(sortByOldNew);
                      console.log("Sorted By: Oldest To Newest");
                      break;
                    case "A-Z":
                      data.games.sort(sortByAZ);
                      console.log("Sorted By: A To Z");
                      break;
                    case "Z-A":
                      data.games.sort(sortByZA);
                      console.log("Sorted By: Z To A");
                      break;
                    default:
                      console.log("Sorted By: None");
                      break;
                  }
                  data = matchSearch(data);
                  for (let index = 0; index < data.games.length; index++) {
                      const tblrow = document.createElement("tr");
                      tblrow.style.height = "85px";

                      const linkCell = document.createElement("td");
                      linkCell.style.width = "25%";
                      linkCell.style.height = "85px";

                      const linkData = document.createElement("a");
                      linkData.href = "https://realdunkin.github.io/dunkingames/games/" + data.games[index].url + "/";
                      
                      const strong1 = document.createElement("strong");
                      strong1.style.fontSize = "20px";
                      strong1.innerHTML = data.games[index].name;

                      const descCell = document.createElement("td");
                      descCell.style.width = "75%";
                      descCell.style.height = "85px";

                      const strong2 = document.createElement("strong");
                      strong2.innerHTML = data.games[index].description;
                      strong2.style.fontSize = "15px";
                      
                      linkData.append(strong1);
                      linkCell.append(linkData);
                      tblrow.append(linkCell);

                      descCell.append(strong2);
                      tblrow.append(descCell);

                      const chart = document.getElementById("DaChart");
                      chart.append(tblrow); 
                    }
                  })
        }
        makeList()
      </script>
    </div>
  </body>
</html>
