/*
 TweenJS
 Visit http://createjs.com/ for documentation, updates and examples.

 Copyright (c) 2010 gskinner.com, inc.

 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
 files (the "Software"), to deal in the Software without
 restriction, including without limitation the rights to use,
 copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following
 conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 OTHER DEALINGS IN THE SOFTWARE.
 Platform.js <https://mths.be/platform>
 Copyright 2014-2018 Benjamin Tan <https://bnjmnt4n.now.sh/>
 Copyright 2011-2013 John-David Dalton
 Available under MIT license <https://mths.be/mit>
*/
this.createjs=this.createjs||{};createjs.extend=function(a,g){function b(){this.constructor=a}b.prototype=g.prototype;return a.prototype=new b};this.createjs=this.createjs||{};createjs.promote=function(a,g){var b=a.prototype,e=Object.getPrototypeOf&&Object.getPrototypeOf(b)||b.__proto__;if(e){b[(g+="_")+"constructor"]=e.constructor;for(var d in e)b.hasOwnProperty(d)&&"function"==typeof e[d]&&(b[g+d]=e[d])}return a};this.createjs=this.createjs||{};
createjs.deprecate=function(a,g){return function(){var b="Deprecated property or method '"+g+"'. See docs for info.";console&&(console.warn?console.warn(b):console.log(b));return a&&a.apply(this,arguments)}};this.createjs=this.createjs||{};
(function(){function a(b,e,d){this.type=b;this.currentTarget=this.target=null;this.eventPhase=0;this.bubbles=!!e;this.cancelable=!!d;this.timeStamp=(new Date).getTime();this.removed=this.immediatePropagationStopped=this.propagationStopped=this.defaultPrevented=!1}var g=a.prototype;g.preventDefault=function(){this.defaultPrevented=this.cancelable&&!0};g.stopPropagation=function(){this.propagationStopped=!0};g.stopImmediatePropagation=function(){this.immediatePropagationStopped=this.propagationStopped=
!0};g.remove=function(){this.removed=!0};g.clone=function(){return new a(this.type,this.bubbles,this.cancelable)};g.set=function(b){for(var e in b)this[e]=b[e];return this};g.toString=function(){return"[Event (type="+this.type+")]"};createjs.Event=a})();this.createjs=this.createjs||{};
(function(){function a(){this._captureListeners=this._listeners=null}var g=a.prototype;a.initialize=function(b){b.addEventListener=g.addEventListener;b.on=g.on;b.removeEventListener=b.off=g.removeEventListener;b.removeAllEventListeners=g.removeAllEventListeners;b.hasEventListener=g.hasEventListener;b.dispatchEvent=g.dispatchEvent;b._dispatchEvent=g._dispatchEvent;b.willTrigger=g.willTrigger};g.addEventListener=function(b,e,d){var c=d?this._captureListeners=this._captureListeners||{}:this._listeners=
this._listeners||{};var f=c[b];f&&this.removeEventListener(b,e,d);(f=c[b])?f.push(e):c[b]=[e];return e};g.on=function(b,e,d,c,f,h){e.handleEvent&&(d=d||e,e=e.handleEvent);d=d||this;return this.addEventListener(b,function(k){e.call(d,k,f);c&&k.remove()},h)};g.removeEventListener=function(b,e,d){if(d=d?this._captureListeners:this._listeners){var c=d[b];if(c)for(var f=0,h=c.length;f<h;f++)if(c[f]==e){1==h?delete d[b]:c.splice(f,1);break}}};g.off=g.removeEventListener;g.removeAllEventListeners=function(b){b?
(this._listeners&&delete this._listeners[b],this._captureListeners&&delete this._captureListeners[b]):this._listeners=this._captureListeners=null};g.dispatchEvent=function(b,e,d){if("string"==typeof b){var c=this._listeners;if(!(e||c&&c[b]))return!0;b=new createjs.Event(b,e,d)}else b.target&&b.clone&&(b=b.clone());try{b.target=this}catch(f){}if(b.bubbles&&this.parent){d=this;for(e=[d];d.parent;)e.push(d=d.parent);c=e.length;for(d=c-1;0<=d&&!b.propagationStopped;d--)e[d]._dispatchEvent(b,1+(0==d));
for(d=1;d<c&&!b.propagationStopped;d++)e[d]._dispatchEvent(b,3)}else this._dispatchEvent(b,2);return!b.defaultPrevented};g.hasEventListener=function(b){var e=this._listeners,d=this._captureListeners;return!!(e&&e[b]||d&&d[b])};g.willTrigger=function(b){for(var e=this;e;){if(e.hasEventListener(b))return!0;e=e.parent}return!1};g.toString=function(){return"[EventDispatcher]"};g._dispatchEvent=function(b,e){var d,c,f=2>=e?this._captureListeners:this._listeners;if(b&&f&&(c=f[b.type])&&(d=c.length)){try{b.currentTarget=
this}catch(k){}try{b.eventPhase=e|0}catch(k){}b.removed=!1;c=c.slice();for(f=0;f<d&&!b.immediatePropagationStopped;f++){var h=c[f];h.handleEvent?h.handleEvent(b):h(b);b.removed&&(this.off(b.type,h,1==e),b.removed=!1)}}2===e&&this._dispatchEvent(b,2.1)};createjs.EventDispatcher=a})();this.createjs=this.createjs||{};
(function(){function a(){throw"Ticker cannot be instantiated.";}a.RAF_SYNCHED="synched";a.RAF="raf";a.TIMEOUT="timeout";a.timingMode=null;a.maxDelta=0;a.paused=!1;a.removeEventListener=null;a.removeAllEventListeners=null;a.dispatchEvent=null;a.hasEventListener=null;a._listeners=null;createjs.EventDispatcher.initialize(a);a._addEventListener=a.addEventListener;a.addEventListener=function(){!a._inited&&a.init();return a._addEventListener.apply(a,arguments)};a._inited=!1;a._startTime=0;a._pausedTime=
0;a._ticks=0;a._pausedTicks=0;a._interval=50;a._lastTime=0;a._times=null;a._tickTimes=null;a._timerId=null;a._raf=!0;a._setInterval=function(e){a._interval=e;a._inited&&a._setupTick()};a.setInterval=createjs.deprecate(a._setInterval,"Ticker.setInterval");a._getInterval=function(){return a._interval};a.getInterval=createjs.deprecate(a._getInterval,"Ticker.getInterval");a._setFPS=function(e){a._setInterval(1E3/e)};a.setFPS=createjs.deprecate(a._setFPS,"Ticker.setFPS");a._getFPS=function(){return 1E3/
a._interval};a.getFPS=createjs.deprecate(a._getFPS,"Ticker.getFPS");try{Object.defineProperties(a,{interval:{get:a._getInterval,set:a._setInterval},framerate:{get:a._getFPS,set:a._setFPS}})}catch(e){console.log(e)}a.init=function(){a._inited||(a._inited=!0,a._times=[],a._tickTimes=[],a._startTime=a._getTime(),a._times.push(a._lastTime=0),a.interval=a._interval)};a.reset=function(){if(a._raf){var e=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||
window.msCancelAnimationFrame;e&&e(a._timerId)}else clearTimeout(a._timerId);a.removeAllEventListeners("tick");a._timerId=a._times=a._tickTimes=null;a._startTime=a._lastTime=a._ticks=a._pausedTime=0;a._inited=!1};a.getMeasuredTickTime=function(e){var d=0,c=a._tickTimes;if(!c||1>c.length)return-1;e=Math.min(c.length,e||a._getFPS()|0);for(var f=0;f<e;f++)d+=c[f];return d/e};a.getMeasuredFPS=function(e){var d=a._times;if(!d||2>d.length)return-1;e=Math.min(d.length-1,e||a._getFPS()|0);return 1E3/((d[0]-
d[e])/e)};a.getTime=function(e){return a._startTime?a._getTime()-(e?a._pausedTime:0):-1};a.getEventTime=function(e){return a._startTime?(a._lastTime||a._startTime)-(e?a._pausedTime:0):-1};a.getTicks=function(e){return a._ticks-(e?a._pausedTicks:0)};a._handleSynch=function(){a._timerId=null;a._setupTick();a._getTime()-a._lastTime>=.97*(a._interval-1)&&a._tick()};a._handleRAF=function(){a._timerId=null;a._setupTick();a._tick()};a._handleTimeout=function(){a._timerId=null;a._setupTick();a._tick()};a._setupTick=
function(){if(null==a._timerId){var e=a.timingMode;if(e==a.RAF_SYNCHED||e==a.RAF){var d=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;if(d){a._timerId=d(e==a.RAF?a._handleRAF:a._handleSynch);a._raf=!0;return}}a._raf=!1;a._timerId=setTimeout(a._handleTimeout,a._interval)}};a._tick=function(){var e=a.paused,d=a._getTime(),c=d-a._lastTime;a._lastTime=d;a._ticks++;e&&(a._pausedTicks++,a._pausedTime+=
c);if(a.hasEventListener("tick")){var f=new createjs.Event("tick"),h=a.maxDelta;f.delta=h&&c>h?h:c;f.paused=e;f.time=d;f.runTime=d-a._pausedTime;a.dispatchEvent(f)}for(a._tickTimes.unshift(a._getTime()-d);100<a._tickTimes.length;)a._tickTimes.pop();for(a._times.unshift(d);100<a._times.length;)a._times.pop()};var g=window,b=g.performance.now||g.performance.mozNow||g.performance.msNow||g.performance.oNow||g.performance.webkitNow;a._getTime=function(){return(b&&b.call(g.performance)||(new Date).getTime())-
a._startTime};createjs.Ticker=a})();this.createjs=this.createjs||{};
(function(){function a(b){this.EventDispatcher_constructor();this.ignoreGlobalPause=!1;this.loop=0;this.bounce=this.reversed=this.useTicks=!1;this.timeScale=1;this.position=this.duration=0;this.rawPosition=-1;this._paused=!0;this._labelList=this._labels=this._parent=this._prev=this._next=null;b&&(this.useTicks=!!b.useTicks,this.ignoreGlobalPause=!!b.ignoreGlobalPause,this.loop=!0===b.loop?-1:b.loop||0,this.reversed=!!b.reversed,this.bounce=!!b.bounce,this.timeScale=b.timeScale||1,b.onChange&&this.addEventListener("change",
b.onChange),b.onComplete&&this.addEventListener("complete",b.onComplete))}var g=createjs.extend(a,createjs.EventDispatcher);g._setPaused=function(b){createjs.Tween._register(this,b);return this};g.setPaused=createjs.deprecate(g._setPaused,"AbstractTween.setPaused");g._getPaused=function(){return this._paused};g.getPaused=createjs.deprecate(g._getPaused,"AbstactTween.getPaused");g._getCurrentLabel=function(b){var e=this.getLabels();null==b&&(b=this.position);for(var d=0,c=e.length;d<c&&!(b<e[d].position);d++);
return 0===d?null:e[d-1].label};g.getCurrentLabel=createjs.deprecate(g._getCurrentLabel,"AbstractTween.getCurrentLabel");try{Object.defineProperties(g,{paused:{set:g._setPaused,get:g._getPaused},currentLabel:{get:g._getCurrentLabel}})}catch(b){}g.advance=function(b,e){this.setPosition(this.rawPosition+b*this.timeScale,e)};g.setPosition=function(b,e,d,c){var f=this.duration,h=this.loop,k=this.rawPosition,l=0;0>b&&(b=0);if(0===f){var m=!0;if(-1!==k)return m}else{var n=b/f|0;l=b-n*f;(m=-1!==h&&b>=h*
f+f)&&(b=(l=f)*(n=h)+f);if(b===k)return m;!this.reversed!==!(this.bounce&&n%2)&&(l=f-l)}this.position=l;this.rawPosition=b;this._updatePosition(d,m);m&&(this.paused=!0);c&&c(this);e||this._runActions(k,b,d,!d&&-1===k);this.dispatchEvent("change");m&&this.dispatchEvent("complete")};g.calculatePosition=function(b){var e=this.duration,d=this.loop,c=0;if(0===e)return 0;-1!==d&&b>=d*e+e?(b=e,c=d):0>b?b=0:(c=b/e|0,b-=c*e);return!this.reversed!==!(this.bounce&&c%2)?e-b:b};g.getLabels=function(){var b=this._labelList;
if(!b){b=this._labelList=[];var e=this._labels,d;for(d in e)b.push({label:d,position:e[d]});b.sort(function(c,f){return c.position-f.position})}return b};g.setLabels=function(b){this._labels=b;this._labelList=null};g.addLabel=function(b,e){this._labels||(this._labels={});this._labels[b]=e;var d=this._labelList;if(d){for(var c=0,f=d.length;c<f&&!(e<d[c].position);c++);d.splice(c,0,{label:b,position:e})}};g.gotoAndPlay=function(b){this.paused=!1;this._goto(b)};g.gotoAndStop=function(b){this.paused=
!0;this._goto(b)};g.resolve=function(b){var e=Number(b);isNaN(e)&&(e=this._labels&&this._labels[b]);return e};g.toString=function(){return"[AbstractTween]"};g.clone=function(){throw"AbstractTween can not be cloned.";};g._init=function(b){b&&b.paused||(this.paused=!1);b&&null!=b.position&&this.setPosition(b.position)};g._updatePosition=function(b,e){};g._goto=function(b){b=this.resolve(b);null!=b&&this.setPosition(b,!1,!0)};g._runActions=function(b,e,d,c){if(this._actionHead||this.tweens){var f=this.duration,
h=this.reversed,k=this.bounce,l=this.loop,m,n,p;if(0===f){var q=m=n=p=0;h=k=!1}else q=b/f|0,m=e/f|0,n=b-q*f,p=e-m*f;-1!==l&&(m>l&&(p=f,m=l),q>l&&(n=f,q=l));if(d)return this._runActionsRange(p,p,d,c);if(q!==m||n!==p||d||c){-1===q&&(q=n=0);b=b<=e;e=q;do{l=e===q?n:b?0:f;var r=e===m?p:b?f:0;!h!==!(k&&e%2)&&(l=f-l,r=f-r);if((!k||e===q||l!==r)&&this._runActionsRange(l,r,d,c||e!==q&&!k))return!0;c=!1}while(b&&++e<=m||!b&&--e>=m)}}};g._runActionsRange=function(b,e,d,c){};createjs.AbstractTween=createjs.promote(a,
"EventDispatcher")})();this.createjs=this.createjs||{};
(function(){function a(d,c){this.AbstractTween_constructor(c);this.pluginData=null;this.target=d;this.passive=!1;this._stepTail=this._stepHead=new g(null,0,0,{},null,!0);this._stepPosition=0;this._injected=this._pluginIds=this._plugins=this._actionTail=this._actionHead=null;c&&(this.pluginData=c.pluginData,c.override&&a.removeTweens(d));this.pluginData||(this.pluginData={});this._init(c)}function g(d,c,f,h,k,l){this.next=null;this.prev=d;this.t=c;this.d=f;this.props=h;this.ease=k;this.passive=l;this.index=
d?d.index+1:0}function b(d,c,f,h,k){this.next=null;this.prev=d;this.t=c;this.d=0;this.scope=f;this.funct=h;this.params=k}var e=createjs.extend(a,createjs.AbstractTween);a.IGNORE={};a._tweens=[];a._plugins=null;a._tweenHead=null;a._tweenTail=null;a.get=function(d,c){return new a(d,c)};a.tick=function(d,c){for(var f=a._tweenHead;f;){var h=f._next;c&&!f.ignoreGlobalPause||f._paused||f.advance(f.useTicks?1:d);f=h}};a.handleEvent=function(d){"tick"===d.type&&this.tick(d.delta,d.paused)};a.removeTweens=
function(d){if(d.tweenjs_count){for(var c=a._tweenHead;c;){var f=c._next;c.target===d&&a._register(c,!0);c=f}d.tweenjs_count=0}};a.removeAllTweens=function(){for(var d=a._tweenHead;d;){var c=d._next;d._paused=!0;d.target&&(d.target.tweenjs_count=0);d._next=d._prev=null;d=c}a._tweenHead=a._tweenTail=null};a.hasActiveTweens=function(d){return d?!!d.tweenjs_count:!!a._tweenHead};a._installPlugin=function(d){for(var c=d.priority=d.priority||0,f=a._plugins=a._plugins||[],h=0,k=f.length;h<k&&!(c<f[h].priority);h++);
f.splice(h,0,d)};a._register=function(d,c){var f=d.target;if(!c&&d._paused)f&&(f.tweenjs_count=f.tweenjs_count?f.tweenjs_count+1:1),(f=a._tweenTail)?(a._tweenTail=f._next=d,d._prev=f):a._tweenHead=a._tweenTail=d,!a._inited&&createjs.Ticker&&(createjs.Ticker.addEventListener("tick",a),a._inited=!0);else if(c&&!d._paused){f&&f.tweenjs_count--;f=d._next;var h=d._prev;f?f._prev=h:a._tweenTail=h;h?h._next=f:a._tweenHead=f;d._next=d._prev=null}d._paused=c};e.wait=function(d,c){0<d&&this._addStep(+d,this._stepTail.props,
null,c);return this};e.to=function(d,c,f){if(null==c||0>c)c=0;c=this._addStep(+c,null,f);this._appendProps(d,c);return this};e.label=function(d){this.addLabel(d,this.duration);return this};e.call=function(d,c,f){return this._addAction(f||this.target,d,c||[this])};e.set=function(d,c){return this._addAction(c||this.target,this._set,[d])};e.play=function(d){return this._addAction(d||this,this._set,[{paused:!1}])};e.pause=function(d){return this._addAction(d||this,this._set,[{paused:!0}])};e.w=e.wait;
e.t=e.to;e.c=e.call;e.s=e.set;e.toString=function(){return"[Tween]"};e.clone=function(){throw"Tween can not be cloned.";};e._addPlugin=function(d){var c=this._pluginIds||(this._pluginIds={}),f=d.ID;if(f&&!c[f]){c[f]=!0;c=this._plugins||(this._plugins=[]);f=d.priority||0;for(var h=0,k=c.length;h<k;h++)if(f<c[h].priority){c.splice(h,0,d);return}c.push(d)}};e._updatePosition=function(d,c){var f=this._stepHead.next,h=this.position,k=this.duration;if(this.target&&f){for(var l=f.next;l&&l.t<=h;)f=f.next,
l=f.next;this._updateTargetProps(f,c?0===k?1:h/k:(h-f.t)/f.d,c)}this._stepPosition=f?h-f.t:0};e._updateTargetProps=function(d,c,f){if(!(this.passive=!!d.passive)){var h,k=d.prev.props,l=d.props;if(h=d.ease)c=h(c,0,1,1);h=this._plugins;var m;a:for(m in k){var n=k[m];var p=l[m];n=n!==p&&"number"===typeof n?n+(p-n)*c:1<=c?p:n;if(h){p=0;for(var q=h.length;p<q;p++){var r=h[p].change(this,d,m,n,c,f);if(r===a.IGNORE)continue a;void 0!==r&&(n=r)}}this.target[m]=n}}};e._runActionsRange=function(d,c,f,h){var k=
(f=d>c)?this._actionTail:this._actionHead,l=c,m=d;f&&(l=d,m=c);for(var n=this.position;k;){var p=k.t;if(p===c||p>m&&p<l||h&&p===d)if(k.funct.apply(k.scope,k.params),n!==this.position)return!0;k=f?k.prev:k.next}};e._appendProps=function(d,c,f){var h=this._stepHead.props,k=this.target,l=a._plugins,m,n,p=c.prev,q=p.props,r=c.props||(c.props=this._cloneProps(q)),t={};for(m in d)if(d.hasOwnProperty(m)&&(t[m]=r[m]=d[m],void 0===h[m])){var u=void 0;if(l)for(n=l.length-1;0<=n;n--){var F=l[n].init(this,m,
u);void 0!==F&&(u=F);if(u===a.IGNORE){delete r[m];delete t[m];break}}u!==a.IGNORE&&(void 0===u&&(u=k[m]),q[m]=void 0===u?null:u)}for(m in t){var w;for(d=p;(w=d)&&(d=w.prev);)if(d.props!==w.props){if(void 0!==d.props[m])break;d.props[m]=q[m]}}if(!1!==f&&(l=this._plugins))for(n=l.length-1;0<=n;n--)l[n].step(this,c,t);if(f=this._injected)this._injected=null,this._appendProps(f,c,!1)};e._injectProp=function(d,c){(this._injected||(this._injected={}))[d]=c};e._addStep=function(d,c,f,h){c=new g(this._stepTail,
this.duration,d,c,f,h||!1);this.duration+=d;return this._stepTail=this._stepTail.next=c};e._addAction=function(d,c,f){d=new b(this._actionTail,this.duration,d,c,f);this._actionTail?this._actionTail.next=d:this._actionHead=d;this._actionTail=d;return this};e._set=function(d){for(var c in d)this[c]=d[c]};e._cloneProps=function(d){var c={},f;for(f in d)c[f]=d[f];return c};createjs.Tween=createjs.promote(a,"AbstractTween")})();this.createjs=this.createjs||{};
(function(){function a(b){if(b instanceof Array||null==b&&1<arguments.length){var e=b;var d=arguments[1];b=arguments[2]}else b&&(e=b.tweens,d=b.labels);this.AbstractTween_constructor(b);this.tweens=[];e&&this.addTween.apply(this,e);this.setLabels(d);this._init(b)}var g=createjs.extend(a,createjs.AbstractTween);g.addTween=function(b){b._parent&&b._parent.removeTween(b);var e=arguments.length;if(1<e){for(var d=0;d<e;d++)this.addTween(arguments[d]);return arguments[e-1]}if(0===e)return null;this.tweens.push(b);
b._parent=this;b.paused=!0;e=b.duration;0<b.loop&&(e*=b.loop+1);e>this.duration&&(this.duration=e);0<=this.rawPosition&&b.setPosition(this.rawPosition);return b};g.removeTween=function(b){var e=arguments.length;if(1<e){for(var d=!0,c=0;c<e;c++)d=d&&this.removeTween(arguments[c]);return d}if(0===e)return!0;e=this.tweens;for(c=e.length;c--;)if(e[c]===b)return e.splice(c,1),b._parent=null,b.duration>=this.duration&&this.updateDuration(),!0;return!1};g.updateDuration=function(){for(var b=this.duration=
0,e=this.tweens.length;b<e;b++){var d=this.tweens[b],c=d.duration;0<d.loop&&(c*=d.loop+1);c>this.duration&&(this.duration=c)}};g.toString=function(){return"[Timeline]"};g.clone=function(){throw"Timeline can not be cloned.";};g._updatePosition=function(b,e){for(var d=this.position,c=0,f=this.tweens.length;c<f;c++)this.tweens[c].setPosition(d,!0,b)};g._runActionsRange=function(b,e,d,c){for(var f=this.position,h=0,k=this.tweens.length;h<k;h++)if(this.tweens[h]._runActions(b,e,d,c),f!==this.position)return!0};
createjs.Timeline=createjs.promote(a,"AbstractTween")})();this.createjs=this.createjs||{};
(function(){function a(){throw"Ease cannot be instantiated.";}a.linear=function(g){return g};a.none=a.linear;a.get=function(g){-1>g?g=-1:1<g&&(g=1);return function(b){return 0==g?b:0>g?b*(b*-g+1+g):b*((2-b)*g+(1-g))}};a.getPowIn=function(g){return function(b){return Math.pow(b,g)}};a.getPowOut=function(g){return function(b){return 1-Math.pow(1-b,g)}};a.getPowInOut=function(g){return function(b){return 1>(b*=2)?.5*Math.pow(b,g):1-.5*Math.abs(Math.pow(2-b,g))}};a.quadIn=a.getPowIn(2);a.quadOut=a.getPowOut(2);
a.quadInOut=a.getPowInOut(2);a.cubicIn=a.getPowIn(3);a.cubicOut=a.getPowOut(3);a.cubicInOut=a.getPowInOut(3);a.quartIn=a.getPowIn(4);a.quartOut=a.getPowOut(4);a.quartInOut=a.getPowInOut(4);a.quintIn=a.getPowIn(5);a.quintOut=a.getPowOut(5);a.quintInOut=a.getPowInOut(5);a.sineIn=function(g){return 1-Math.cos(g*Math.PI/2)};a.sineOut=function(g){return Math.sin(g*Math.PI/2)};a.sineInOut=function(g){return-.5*(Math.cos(Math.PI*g)-1)};a.getBackIn=function(g){return function(b){return b*b*((g+1)*b-g)}};
a.backIn=a.getBackIn(1.7);a.getBackOut=function(g){return function(b){return--b*b*((g+1)*b+g)+1}};a.backOut=a.getBackOut(1.7);a.getBackInOut=function(g){g*=1.525;return function(b){return 1>(b*=2)?.5*b*b*((g+1)*b-g):.5*((b-=2)*b*((g+1)*b+g)+2)}};a.backInOut=a.getBackInOut(1.7);a.circIn=function(g){return-(Math.sqrt(1-g*g)-1)};a.circOut=function(g){return Math.sqrt(1- --g*g)};a.circInOut=function(g){return 1>(g*=2)?-.5*(Math.sqrt(1-g*g)-1):.5*(Math.sqrt(1-(g-=2)*g)+1)};a.bounceIn=function(g){return 1-
a.bounceOut(1-g)};a.bounceOut=function(g){return g<1/2.75?7.5625*g*g:g<2/2.75?7.5625*(g-=1.5/2.75)*g+.75:g<2.5/2.75?7.5625*(g-=2.25/2.75)*g+.9375:7.5625*(g-=2.625/2.75)*g+.984375};a.bounceInOut=function(g){return.5>g?.5*a.bounceIn(2*g):.5*a.bounceOut(2*g-1)+.5};a.getElasticIn=function(g,b){var e=2*Math.PI;return function(d){if(0==d||1==d)return d;var c=b/e*Math.asin(1/g);return-(g*Math.pow(2,10*--d)*Math.sin((d-c)*e/b))}};a.elasticIn=a.getElasticIn(1,.3);a.getElasticOut=function(g,b){var e=2*Math.PI;
return function(d){return 0==d||1==d?d:g*Math.pow(2,-10*d)*Math.sin((d-b/e*Math.asin(1/g))*e/b)+1}};a.elasticOut=a.getElasticOut(1,.3);a.getElasticInOut=function(g,b){var e=2*Math.PI;return function(d){var c=b/e*Math.asin(1/g);return 1>(d*=2)?-.5*g*Math.pow(2,10*--d)*Math.sin((d-c)*e/b):g*Math.pow(2,-10*--d)*Math.sin((d-c)*e/b)*.5+1}};a.elasticInOut=a.getElasticInOut(1,.3*1.5);createjs.Ease=a})();this.createjs=this.createjs||{};
(function(){function a(){throw"MotionGuidePlugin cannot be instantiated.";}a.priority=0;a.ID="MotionGuide";a.install=function(){createjs.Tween._installPlugin(a);return createjs.Tween.IGNORE};a.init=function(g,b,e){"guide"==b&&g._addPlugin(a)};a.step=function(g,b,e){for(var d in e)if("guide"===d){var c=b.props.guide,f=a._solveGuideData(e.guide,c);c.valid=!f;var h=c.endData;g._injectProp("x",h.x);g._injectProp("y",h.y);if(f||!c.orient)break;c.startOffsetRot=(void 0===b.prev.props.rotation?g.target.rotation||
0:b.prev.props.rotation)-c.startData.rotation;if("fixed"==c.orient)c.endAbsRot=h.rotation+c.startOffsetRot,c.deltaRotation=0;else{f=void 0===e.rotation?g.target.rotation||0:e.rotation;h=f-c.endData.rotation-c.startOffsetRot;var k=h%360;c.endAbsRot=f;switch(c.orient){case "auto":c.deltaRotation=h;break;case "cw":c.deltaRotation=(k+360)%360+360*Math.abs(h/360|0);break;case "ccw":c.deltaRotation=(k-360)%360+-360*Math.abs(h/360|0)}}g._injectProp("rotation",c.endAbsRot)}};a.change=function(g,b,e,d,c,f){if((d=
b.props.guide)&&b.props!==b.prev.props&&d!==b.prev.props.guide){if("guide"===e&&!d.valid||"x"==e||"y"==e||"rotation"===e&&d.orient)return createjs.Tween.IGNORE;a._ratioToPositionData(c,d,g.target)}};a.debug=function(g,b,e){g=g.guide||g;var d=a._findPathProblems(g);d&&console.error("MotionGuidePlugin Error found: \n"+d);if(!b)return d;var c,f=g.path,h=f.length;b.save();b.lineCap="round";b.lineJoin="miter";b.beginPath();b.moveTo(f[0],f[1]);for(c=2;c<h;c+=4)b.quadraticCurveTo(f[c],f[c+1],f[c+2],f[c+
3]);b.strokeStyle="black";b.lineWidth=4.5;b.stroke();b.strokeStyle="white";b.lineWidth=3;b.stroke();b.closePath();f=e.length;if(e&&f){h={};var k={};a._solveGuideData(g,h);for(c=0;c<f;c++)h.orient="fixed",a._ratioToPositionData(e[c],h,k),b.beginPath(),b.moveTo(k.x,k.y),b.lineTo(k.x+9*Math.cos(.0174533*k.rotation),k.y+9*Math.sin(.0174533*k.rotation)),b.strokeStyle="black",b.lineWidth=4.5,b.stroke(),b.strokeStyle="red",b.lineWidth=3,b.stroke(),b.closePath()}b.restore();return d};a._solveGuideData=function(g,
b){var e;if(e=a.debug(g))return e;var d=b.path=g.path;b.orient=g.orient;b.subLines=[];b.totalLength=0;b.startOffsetRot=0;b.deltaRotation=0;b.startData={ratio:0};b.endData={ratio:1};b.animSpan=1;var c=d.length,f,h={};var k=d[0];var l=d[1];for(e=2;e<c;e+=4){var m=d[e];var n=d[e+1];var p=d[e+2];var q=d[e+3];var r={weightings:[],estLength:0,portion:0},t=k;var u=l;for(f=1;10>=f;f++)a._getParamsForCurve(k,l,m,n,p,q,f/10,!1,h),t=h.x-t,u=h.y-u,u=Math.sqrt(t*t+u*u),r.weightings.push(u),r.estLength+=u,t=h.x,
u=h.y;b.totalLength+=r.estLength;for(f=0;10>f;f++)u=r.estLength,r.weightings[f]/=u;b.subLines.push(r);k=p;l=q}u=b.totalLength;d=b.subLines.length;for(e=0;e<d;e++)b.subLines[e].portion=b.subLines[e].estLength/u;e=isNaN(g.start)?0:g.start;d=isNaN(g.end)?1:g.end;a._ratioToPositionData(e,b,b.startData);a._ratioToPositionData(d,b,b.endData);b.startData.ratio=e;b.endData.ratio=d;b.animSpan=b.endData.ratio-b.startData.ratio};a._ratioToPositionData=function(g,b,e){var d=b.subLines,c,f=0,h=g*b.animSpan+b.startData.ratio;
var k=d.length;for(c=0;c<k;c++){var l=d[c].portion;if(f+l>=h){var m=c;break}f+=l}void 0===m&&(m=k-1,f-=l);d=d[m].weightings;var n=l;k=d.length;for(c=0;c<k;c++){l=d[c]*n;if(f+l>=h)break;f+=l}m=4*m+2;k=b.path;a._getParamsForCurve(k[m-2],k[m-1],k[m],k[m+1],k[m+2],k[m+3],c/10+(h-f)/l*.1,b.orient,e);b.orient&&(e.rotation=.99999<=g&&1.00001>=g&&void 0!==b.endAbsRot?b.endAbsRot:e.rotation+(b.startOffsetRot+g*b.deltaRotation));return e};a._getParamsForCurve=function(g,b,e,d,c,f,h,k,l){var m=1-h;l.x=m*m*g+
2*m*h*e+h*h*c;l.y=m*m*b+2*m*h*d+h*h*f;k&&(l.rotation=57.2957795*Math.atan2((d-b)*m+(f-d)*h,(e-g)*m+(c-e)*h))};a._findPathProblems=function(g){var b=g.path,e=b&&b.length||0;if(6>e||(e-2)%4)return"\tCannot parse 'path' array due to invalid number of entries in path. There should be an odd number of points, at least 3 points, and 2 entries per point (x & y). See 'CanvasRenderingContext2D.quadraticCurveTo' for details as 'path' models a quadratic bezier.\n\nOnly [ "+(e+" ] values found. Expected: "+Math.max(4*
Math.ceil((e-2)/4)+2,6));for(var d=0;d<e;d++)if(isNaN(b[d]))return"All data in path array must be numeric";b=g.start;if(isNaN(b)&&void 0!==b)return"'start' out of bounds. Expected 0 to 1, got: "+b;b=g.end;if(isNaN(b)&&void 0!==b)return"'end' out of bounds. Expected 0 to 1, got: "+b;if((g=g.orient)&&"fixed"!=g&&"auto"!=g&&"cw"!=g&&"ccw"!=g)return'Invalid orientation value. Expected ["fixed", "auto", "cw", "ccw", undefined], got: '+g};createjs.MotionGuidePlugin=a})();this.createjs=this.createjs||{};
(function(){var a=createjs.TweenJS=createjs.TweenJS||{};a.version="1.0.0";a.buildDate="Thu, 14 Sep 2017 19:47:47 GMT"})();
(function(){var a="undefined"!==typeof window&&"undefined"!==typeof window.document?window.document:{},g="undefined"!==typeof module&&module.exports,b=function(){for(var c,f=["requestFullscreen exitFullscreen fullscreenElement fullscreenEnabled fullscreenchange fullscreenerror".split(" "),"webkitRequestFullscreen webkitExitFullscreen webkitFullscreenElement webkitFullscreenEnabled webkitfullscreenchange webkitfullscreenerror".split(" "),"webkitRequestFullScreen webkitCancelFullScreen webkitCurrentFullScreenElement webkitCancelFullScreen webkitfullscreenchange webkitfullscreenerror".split(" "),
"mozRequestFullScreen mozCancelFullScreen mozFullScreenElement mozFullScreenEnabled mozfullscreenchange mozfullscreenerror".split(" "),"msRequestFullscreen msExitFullscreen msFullscreenElement msFullscreenEnabled MSFullscreenChange MSFullscreenError".split(" ")],h=0,k=f.length,l={};h<k;h++)if((c=f[h])&&c[1]in a){for(h=0;h<c.length;h++)l[f[0][h]]=c[h];return l}return!1}(),e={change:b.fullscreenchange,error:b.fullscreenerror},d={request:function(c){return new Promise(function(f,h){var k=function(){this.off("change",
k);f()}.bind(this);this.on("change",k);c=c||a.documentElement;Promise.resolve(c[b.requestFullscreen]())["catch"](h)}.bind(this))},exit:function(){return new Promise(function(c,f){if(this.isFullscreen){var h=function(){this.off("change",h);c()}.bind(this);this.on("change",h);Promise.resolve(a[b.exitFullscreen]())["catch"](f)}else c()}.bind(this))},toggle:function(c){return this.isFullscreen?this.exit():this.request(c)},onchange:function(c){this.on("change",c)},onerror:function(c){this.on("error",c)},
on:function(c,f){var h=e[c];h&&a.addEventListener(h,f,!1)},off:function(c,f){var h=e[c];h&&a.removeEventListener(h,f,!1)},raw:b};b?(Object.defineProperties(d,{isFullscreen:{get:function(){return!!a[b.fullscreenElement]}},element:{enumerable:!0,get:function(){return a[b.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!a[b.fullscreenEnabled]}}}),g?module.exports=d:window.screenfull=d):g?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}})();
(function(){function a(w){w=String(w);return w.charAt(0).toUpperCase()+w.slice(1)}function g(w,y){var A=-1,x=w?w.length:0;if("number"==typeof x&&-1<x&&x<=q)for(;++A<x;)y(w[A],A,w);else e(w,y)}function b(w){w=String(w).replace(/^ +| +$/g,"");return/^(?:webOS|i(?:OS|P))/.test(w)?w:a(w)}function e(w,y){for(var A in w)t.call(w,A)&&y(w[A],A,w)}function d(w){return null==w?a(w):u.call(w).slice(8,-1)}function c(w,y){var A=null!=w?typeof w[y]:"number";return!/^(?:boolean|number|string|undefined)$/.test(A)&&
("object"==A?!!w[y]:!0)}function f(w){return String(w).replace(/([ -])(?!$)/g,"$1?")}function h(w,y){var A=null;g(w,function(x,B){A=y(A,x,B,w)});return A}function k(w){function y(P){return h(P,function(N,L){var Q=L.pattern||f(L);!N&&(N=RegExp("\\b"+Q+" *\\d+[.\\w_]*","i").exec(w)||RegExp("\\b"+Q+" *\\w+-[\\w]*","i").exec(w)||RegExp("\\b"+Q+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(w))&&((N=String(L.label&&!RegExp(Q,"i").test(L.label)?L.label:N).split("/"))[1]&&!/[\d.]+/.test(N[0])&&(N[0]+=
" "+N[1]),L=L.label||L,N=b(N[0].replace(RegExp(Q,"i"),L).replace(RegExp("; *(?:"+L+"[_-])?","i")," ").replace(RegExp("("+L+")[-_.]?(\\w)","i"),"$1 $2")));return N})}function A(P){return h(P,function(N,L){return N||(RegExp(L+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(w)||0)[1]||null})}var x=m,B=w&&"object"==typeof w&&"String"!=d(w);B&&(x=w,w=null);var I=x.navigator||{},z=I.userAgent||"";w||(w=z);var H=B?!!I.likeChrome:/\bChrome\b/.test(w)&&!/internal|\n/i.test(u.toString()),
C=B?"Object":"ScriptBridgingProxyObject",G=B?"Object":"Environment",M=B&&x.java?"JavaPackage":d(x.java),O=B?"Object":"RuntimeObject";G=(M=/\bJava/.test(M)&&x.java)&&d(x.environment)==G;var V=M?"a":"\u03b1",T=M?"b":"\u03b2",X=x.document||{},R=x.operamini||x.opera,Y=r.test(Y=B&&R?R["[[Class]]"]:d(R))?Y:R=null,v,Z=w;B=[];var aa=null,W=w==z;z=W&&R&&"function"==typeof R.version&&R.version();var J=function(P){return h(P,function(N,L){return N||RegExp("\\b"+(L.pattern||f(L))+"\\b","i").exec(w)&&(L.label||
L)})}([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),D=function(P){return h(P,function(N,L){return N||RegExp("\\b"+(L.pattern||f(L))+"\\b","i").exec(w)&&(L.label||L)})}(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"Edge"},"Midori","Nook Browser",
"PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Waterfox","WebPositive","Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chrome",{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},
{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),K=y([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad",
"iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),S=function(P){return h(P,function(N,L,Q){return N||(L[K]||L[/^[a-z]+(?: +[a-z]+\b)*/i.exec(K)]||RegExp("\\b"+f(Q)+"(?:\\b|\\w*\\d)","i").exec(w))&&Q})}({Apple:{iPad:1,iPhone:1,iPod:1},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},
"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1}}),E=function(P){return h(P,function(N,L){var Q=L.pattern||f(L);if(!N&&(N=RegExp("\\b"+Q+"(?:/[\\d.]+|[ \\w.]*)","i").exec(w))){var U=N,ba=L.label||L,ca={"10.0":"10","6.4":"10 Technical Preview",
"6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};Q&&ba&&/^Win/i.test(U)&&!/^Windows Phone /i.test(U)&&(ca=ca[/[\d.]+$/.exec(U)])&&(U="Windows "+ca);U=String(U);Q&&ba&&(U=U.replace(RegExp(Q,"i"),ba));N=U=b(U.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,
"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0])}return N})}(["Windows Phone","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian","Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X",
"Macintosh","Mac","Windows 98;","Windows "]);J&&(J=[J]);S&&!K&&(K=y([S]));if(v=/\bGoogle TV\b/.exec(K))K=v[0];/\bSimulator\b/i.test(w)&&(K=(K?K+" ":"")+"Simulator");"Opera Mini"==D&&/\bOPiOS\b/.test(w)&&B.push("running in Turbo/Uncompressed mode");"IE"==D&&/\blike iPhone OS\b/.test(w)?(v=k(w.replace(/like iPhone OS/,"")),S=v.manufacturer,K=v.product):/^iP/.test(K)?(D||(D="Safari"),E="iOS"+((v=/ OS ([\d_]+)/i.exec(w))?" "+v[1].replace(/_/g,"."):"")):"Konqueror"!=D||/buntu/i.test(E)?S&&"Google"!=S&&
(/Chrome/.test(D)&&!/\bMobile Safari\b/i.test(w)||/\bVita\b/.test(K))||/\bAndroid\b/.test(E)&&/^Chrome/.test(D)&&/\bVersion\//i.test(w)?(D="Android Browser",E=/\bAndroid\b/.test(E)?E:"Android"):"Silk"==D?(/\bMobi/i.test(w)||(E="Android",B.unshift("desktop mode")),/Accelerated *= *true/i.test(w)&&B.unshift("accelerated")):"PaleMoon"==D&&(v=/\bFirefox\/([\d.]+)\b/.exec(w))?B.push("identifying as Firefox "+v[1]):"Firefox"==D&&(v=/\b(Mobile|Tablet|TV)\b/i.exec(w))?(E||(E="Firefox OS"),K||(K=v[1])):!D||
(v=!/\bMinefield\b/i.test(w)&&/\b(?:Firefox|Safari)\b/.exec(D))?(D&&!K&&/[\/,]|^[^(]+?\)/.test(w.slice(w.indexOf(v+"/")+8))&&(D=null),(v=K||S||E)&&(K||S||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(E))&&(D=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(E)?E:v)+" Browser")):"Electron"==D&&(v=(/\bChrome\/([\d.]+)\b/.exec(w)||0)[1])&&B.push("Chromium "+v):E="Kubuntu";z||(z=A(["(?:Cloud9|CriOS|CrMo|Edge|FxiOS|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$))","Version",f(D),
"(?:Firefox|Minefield|NetFront)"]));if(v="iCab"==J&&3<parseFloat(z)&&"WebKit"||/\bOpera\b/.test(D)&&(/\bOPR\b/.test(w)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(w)&&!/^(?:Trident|EdgeHTML)$/.test(J)&&"WebKit"||!J&&/\bMSIE\b/i.test(w)&&("Mac OS"==E?"Tasman":"Trident")||"WebKit"==J&&/\bPlayStation\b(?! Vita\b)/i.test(D)&&"NetFront")J=[v];"IE"==D&&(v=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(w)||0)[1])?(D+=" Mobile",E="Windows Phone "+(/\+$/.test(v)?v:v+".x"),B.unshift("desktop mode")):/\bWPDesktop\b/i.test(w)?
(D="IE Mobile",E="Windows Phone 8.x",B.unshift("desktop mode"),z||(z=(/\brv:([\d.]+)/.exec(w)||0)[1])):"IE"!=D&&"Trident"==J&&(v=/\brv:([\d.]+)/.exec(w))&&(D&&B.push("identifying as "+D+(z?" "+z:"")),D="IE",z=v[1]);if(W){if(c(x,"global"))if(M&&(v=M.lang.System,Z=v.getProperty("os.arch"),E=E||v.getProperty("os.name")+" "+v.getProperty("os.version")),G){try{z=x.require("ringo/engine").version.join("."),D="RingoJS"}catch(P){(v=x.system)&&v.global.system==x.system&&(D="Narwhal",E||(E=v[0].os||null))}D||
(D="Rhino")}else"object"==typeof x.process&&!x.process.browser&&(v=x.process)&&("object"==typeof v.versions&&("string"==typeof v.versions.electron?(B.push("Node "+v.versions.node),D="Electron",z=v.versions.electron):"string"==typeof v.versions.nw&&(B.push("Chromium "+z,"Node "+v.versions.node),D="NW.js",z=v.versions.nw)),D||(D="Node.js",Z=v.arch,E=v.platform,z=(z=/[\d.]+/.exec(v.version))?z[0]:null));else d(v=x.runtime)==C?(D="Adobe AIR",E=v.flash.system.Capabilities.os):d(v=x.phantom)==O?(D="PhantomJS",
z=(v=v.version||null)&&v.major+"."+v.minor+"."+v.patch):"number"==typeof X.documentMode&&(v=/\bTrident\/(\d+)/i.exec(w))?(z=[z,X.documentMode],(v=+v[1]+4)!=z[1]&&(B.push("IE "+z[1]+" mode"),J&&(J[1]=""),z[1]=v),z="IE"==D?String(z[1].toFixed(1)):z[0]):"number"==typeof X.documentMode&&/^(?:Chrome|Firefox)\b/.test(D)&&(B.push("masking as "+D+" "+z),D="IE",z="11.0",J=["Trident"],E="Windows");E=E&&b(E)}z&&(v=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(z)||/(?:alpha|beta)(?: ?\d)?/i.exec(w+";"+(W&&I.appMinorVersion))||
/\bMinefield\b/i.test(w)&&"a")&&(aa=/b/i.test(v)?"beta":"alpha",z=z.replace(RegExp(v+"\\+?$"),"")+("beta"==aa?T:V)+(/\d+\+?/.exec(v)||""));if("Fennec"==D||"Firefox"==D&&/\b(?:Android|Firefox OS)\b/.test(E))D="Firefox Mobile";else if("Maxthon"==D&&z)z=z.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(K))"Xbox 360"==K&&(E=null),"Xbox 360"==K&&/\bIEMobile\b/.test(w)&&B.unshift("mobile mode");else if(!/^(?:Chrome|IE|Opera)$/.test(D)&&(!D||K||/Browser|Mobi/.test(D))||"Windows CE"!=E&&!/Mobi/i.test(w))if("IE"==
D&&W)try{null===x.external&&B.unshift("platform preview")}catch(P){B.unshift("embedded")}else(/\bBlackBerry\b/.test(K)||/\bBB10\b/.test(w))&&(v=(RegExp(K.replace(/ +/g," *")+"/([.\\d]+)","i").exec(w)||0)[1]||z)?(v=[v,/BB10/.test(w)],E=(v[1]?(K=null,S="BlackBerry"):"Device Software")+" "+v[0],z=null):this!=e&&"Wii"!=K&&(W&&R||/Opera/.test(D)&&/\b(?:MSIE|Firefox)\b/i.test(w)||"Firefox"==D&&/\bOS X (?:\d+\.){2,}/.test(E)||"IE"==D&&(E&&!/^Win/.test(E)&&5.5<z||/\bWindows XP\b/.test(E)&&8<z||8==z&&!/\bTrident\b/.test(w)))&&
!r.test(v=k.call(e,w.replace(r,"")+";"))&&v.name&&(v="ing as "+v.name+((v=v.version)?" "+v:""),r.test(D)?(/\bIE\b/.test(v)&&"Mac OS"==E&&(E=null),v="identify"+v):(v="mask"+v,D=Y?b(Y.replace(/([a-z])([A-Z])/g,"$1 $2")):"Opera",/\bIE\b/.test(v)&&(E=null),W||(z=null)),J=["Presto"],B.push(v));else D+=" Mobile";if(v=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(w)||0)[1]){v=[parseFloat(v.replace(/\.(\d)$/,".0$1")),v];if("Safari"==D&&"+"==v[1].slice(-1))D="WebKit Nightly",aa="alpha",z=v[1].slice(0,-1);else if(z==
v[1]||z==(v[2]=(/\bSafari\/([\d.]+\+?)/i.exec(w)||0)[1]))z=null;v[1]=(/\bChrome\/([\d.]+)/i.exec(w)||0)[1];537.36==v[0]&&537.36==v[2]&&28<=parseFloat(v[1])&&"WebKit"==J&&(J=["Blink"]);W&&(H||v[1])?(J&&(J[1]="like Chrome"),v=v[1]||(v=v[0],530>v?1:532>v?2:532.05>v?3:533>v?4:534.03>v?5:534.07>v?6:534.1>v?7:534.13>v?8:534.16>v?9:534.24>v?10:534.3>v?11:535.01>v?12:535.02>v?"13+":535.07>v?15:535.11>v?16:535.19>v?17:536.05>v?18:536.1>v?19:537.01>v?20:537.11>v?"21+":537.13>v?23:537.18>v?24:537.24>v?25:537.36>
v?26:"Blink"!=J?"27":"28")):(J&&(J[1]="like Safari"),v=(v=v[0],400>v?1:500>v?2:526>v?3:533>v?4:534>v?"4+":535>v?5:537>v?6:538>v?7:601>v?8:"8"));J&&(J[1]+=" "+(v+="number"==typeof v?".x":/[.+]/.test(v)?"":"+"));"Safari"==D&&(!z||45<parseInt(z))&&(z=v)}"Opera"==D&&(v=/\bzbov|zvav$/.exec(E))?(D+=" ",B.unshift("desktop mode"),"zvav"==v?(D+="Mini",z=null):D+="Mobile",E=E.replace(RegExp(" *"+v+"$"),"")):"Safari"==D&&/\bChrome\b/.exec(J&&J[1])&&(B.unshift("desktop mode"),D="Chrome Mobile",z=null,/\bOS X\b/.test(E)?
(S="Apple",E="iOS 4.3+"):E=null);z&&0==z.indexOf(v=/[\d.]+$/.exec(E))&&-1<w.indexOf("/"+v+"-")&&(E=String(E.replace(v,"")).replace(/^ +| +$/g,""));J&&!/\b(?:Avant|Nook)\b/.test(D)&&(/Browser|Lunascape|Maxthon/.test(D)||"Safari"!=D&&/^iOS/.test(E)&&/\bSafari\b/.test(J[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|Web)/.test(D)&&J[1])&&(v=J[J.length-1])&&B.push(v);B.length&&(B=["("+B.join("; ")+")"]);S&&K&&0>K.indexOf(S)&&B.push("on "+S);K&&B.push((/^on /.test(B[B.length-
1])?"":"on ")+K);if(E){var da=(v=/ ([\d.+]+)$/.exec(E))&&"/"==E.charAt(E.length-v[0].length-1);E={architecture:32,family:v&&!da?E.replace(v[0],""):E,version:v?v[1]:null,toString:function(){var P=this.version;return this.family+(P&&!da?" "+P:"")+(64==this.architecture?" 64-bit":"")}}}(v=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Z))&&!/\bi686\b/i.test(Z)?(E&&(E.architecture=64,E.family=E.family.replace(RegExp(" *"+v),"")),D&&(/\bWOW64\b/i.test(w)||W&&/\w(?:86|32)$/.test(I.cpuClass||I.platform)&&!/\bWin64; x64\b/i.test(w))&&
B.unshift("32-bit")):E&&/^OS X/.test(E.family)&&"Chrome"==D&&39<=parseFloat(z)&&(E.architecture=64);w||(w=null);x={};x.description=w;x.layout=J&&J[0];x.manufacturer=S;x.name=D;x.prerelease=aa;x.product=K;x.ua=w;x.version=D&&z;x.os=E||{architecture:null,family:null,version:null,toString:function(){return"null"}};x.parse=k;x.toString=function(){return this.description||""};x.version&&B.unshift(z);x.name&&B.unshift(D);E&&D&&(E!=String(E).split(" ")[0]||E!=D.split(" ")[0]&&!K)&&B.push(K?"("+E+")":"on "+
E);B.length&&(x.description=B.join(" "));return x}var l={"function":!0,object:!0},m=l[typeof window]&&window||this,n=l[typeof exports]&&exports;l=l[typeof module]&&module&&!module.nodeType&&module;var p=n&&l&&"object"==typeof global&&global;!p||p.global!==p&&p.window!==p&&p.self!==p||(m=p);var q=Math.pow(2,53)-1,r=/\bOpera/;p=Object.prototype;var t=p.hasOwnProperty,u=p.toString,F=k();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(m.platform=F,define(function(){return F})):n&&
l?e(F,function(w,y){n[y]=w}):m.platform=F}).call(this);
function buildIOSMeta(){for(var a=[{name:"viewport",content:"width=device-width, height=device-height, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no"},{name:"apple-mobile-web-app-capable",content:"yes"},{name:"apple-mobile-web-app-status-bar-style",content:"black"}],g=0;g<a.length;g++){var b=document.createElement("meta");b.name=a[g].name;b.content=a[g].content;var e=window.document.head.querySelector('meta[name="'+b.name+'"]');e&&e.parentNode.removeChild(e);window.document.head.appendChild(b)}}
function hideIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","none");jQuery(".xxx-ios-fullscreen-scroll").css("display","none");jQuery(".xxx-game-iframe-full").removeClass("xxx-game-iframe-iphone-se")}function buildIOSFullscreenPanel(){jQuery("body").append('<div class="xxx-ios-fullscreen-message"><div class="xxx-ios-fullscreen-swipe"></div></div><div class="xxx-ios-fullscreen-scroll"></div>')}
function showIOSFullscreenPanel(){jQuery(".xxx-ios-fullscreen-message").css("display","block");jQuery(".xxx-ios-fullscreen-scroll").css("display","block")}
function __iosResize(){window.scrollTo(0,0);console.log(window.devicePixelRatio);console.log(window.innerWidth);console.log(window.innerHeight);if("iPhone"===platform.product)switch(window.devicePixelRatio){case 2:switch(window.innerWidth){case 568:320!==window.innerHeight&&jQuery(".xxx-game-iframe-full").addClass("xxx-game-iframe-iphone-se");break;case 667:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();
break;default:hideIOSFullscreenPanel()}break;case 3:switch(window.innerWidth){case 736:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 724:375===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;case 808:414===window.innerHeight?hideIOSFullscreenPanel():showIOSFullscreenPanel();break;default:hideIOSFullscreenPanel()}break;default:hideIOSFullscreenPanel()}}function iosResize(){__iosResize();setTimeout(function(){__iosResize()},500)}
function iosInIframe(){try{return window.self!==window.top}catch(a){return!0}}function isIOSLessThen13(){var a=platform.os,g=a.family.toLowerCase();a=parseFloat(a.version);return"ios"===g&&13>a?!0:!1}$(document).ready(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&(buildIOSFullscreenPanel(),buildIOSMeta())});
jQuery(window).resize(function(){platform&&"iPhone"===platform.product&&"safari"===platform.name.toLowerCase()&&isIOSLessThen13()&&!iosInIframe()&&iosResize()});var s_iScaleFactor=1,s_iOffsetX,s_iOffsetY,s_bIsIphone=!1,s_bFocus=!0;
(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/android|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(ad|hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|tablet|treo|up\.(browser|link)|vodafone|wap|webos|windows (ce|phone)|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(a.substr(0,
4))})(navigator.userAgent||navigator.vendor||window.opera);$(window).resize(function(){sizeHandler()});function trace(a){console.log(a)}
function getSize(a){var g=a.toLowerCase(),b=window.document,e=b.documentElement;if(void 0===window["inner"+a])a=e["client"+a];else if(window["inner"+a]!=e["client"+a]){var d=b.createElement("body");d.id="vpw-test-b";d.style.cssText="overflow:scroll";var c=b.createElement("div");c.id="vpw-test-d";c.style.cssText="position:absolute;top:-1000px";c.innerHTML="<style>@media("+g+":"+e["client"+a]+"px){body#vpw-test-b div#vpw-test-d{"+g+":7px!important}}</style>";d.appendChild(c);e.insertBefore(d,b.head);
a=7==c["offset"+a]?e["client"+a]:window["inner"+a];e.removeChild(d)}else a=window["inner"+a];return a}window.addEventListener("orientationchange",onOrientationChange);function onOrientationChange(){window.matchMedia("(orientation: portrait)").matches&&sizeHandler();window.matchMedia("(orientation: landscape)").matches&&sizeHandler()}function isChrome(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}
function isIpad(){var a=-1!==navigator.userAgent.toLowerCase().indexOf("ipad");return!a&&navigator.userAgent.match(/Mac/)&&navigator.maxTouchPoints&&2<navigator.maxTouchPoints?!0:a}function isMobile(){return isIpad()?!0:jQuery.browser.mobile}function isIOS(){for(var a="iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";");a.length;)if(navigator.platform===a.pop())return s_bIsIphone=!0;return s_bIsIphone=!1}
function getIOSWindowHeight(){return document.documentElement.clientWidth/window.innerWidth*window.innerHeight}function getHeightOfIOSToolbars(){var a=(0===window.orientation?screen.height:screen.width)-getIOSWindowHeight();return 1<a?a:0}
function sizeHandler(){window.scrollTo(0,1);if($("#canvas")){var a=null!==platform.name&&"safari"===platform.name.toLowerCase()?getIOSWindowHeight():getSize("Height");var g=getSize("Width");s_bFocus&&_checkOrientation(g,a);var b=Math.min(a/CANVAS_HEIGHT,g/CANVAS_WIDTH),e=Math.round(CANVAS_WIDTH*b);b=Math.round(CANVAS_HEIGHT*b);if(b<a){var d=a-b;b+=d;e+=CANVAS_WIDTH/CANVAS_HEIGHT*d}else e<g&&(d=g-e,e+=d,b+=CANVAS_HEIGHT/CANVAS_WIDTH*d);d=a/2-b/2;var c=g/2-e/2,f=CANVAS_WIDTH/e;if(c*f<-EDGEBOARD_X||
d*f<-EDGEBOARD_Y)b=Math.min(a/(CANVAS_HEIGHT-2*EDGEBOARD_Y),g/(CANVAS_WIDTH-2*EDGEBOARD_X)),e=Math.round(CANVAS_WIDTH*b),b=Math.round(CANVAS_HEIGHT*b),d=(a-b)/2,c=(g-e)/2,f=CANVAS_WIDTH/e;s_iOffsetX=-1*c*f;s_iOffsetY=-1*d*f;0<=d&&(s_iOffsetY=0);0<=c&&(s_iOffsetX=0);null!==s_oInterface&&s_oInterface.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oMenu&&s_oMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oModeMenu&&s_oModeMenu.refreshButtonPos(s_iOffsetX,s_iOffsetY);null!==s_oSandBoxMenu&&s_oSandBoxMenu.refreshButtonPos(s_iOffsetX,
s_iOffsetY);s_bIsIphone&&s_oStage?(canvas=document.getElementById("canvas"),s_oStage.canvas.width=2*e,s_oStage.canvas.height=2*b,canvas.style.width=e+"px",canvas.style.height=b+"px",s_iScaleFactor=2*Math.min(e/CANVAS_WIDTH,b/CANVAS_HEIGHT),s_oStage.scaleX=s_oStage.scaleY=s_iScaleFactor):s_bMobile||isChrome()?($("#canvas").css("width",e+"px"),$("#canvas").css("height",b+"px")):s_oStage&&(s_oStage.canvas.width=e,s_oStage.canvas.height=b,s_iScaleFactor=Math.min(e/CANVAS_WIDTH,b/CANVAS_HEIGHT),s_oStage.scaleX=
s_oStage.scaleY=s_iScaleFactor);0>d||(d=(a-b)/2);$("#canvas").css("top",d+"px");$("#canvas").css("left",c+"px");fullscreenHandler()}}
function _checkOrientation(a,g){s_bMobile&&ENABLE_CHECK_ORIENTATION&&(a>g?"landscape"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),s_oMain.stopUpdate()):"portrait"===$(".orientation-msg-container").attr("data-orientation")?($(".orientation-msg-container").css("display","none"),s_oMain.startUpdate()):($(".orientation-msg-container").css("display","block"),
s_oMain.stopUpdate()))}function playSound(a,g,b){return!1===DISABLE_SOUND_MOBILE||!1===s_bMobile?(s_aSounds[a].play(),s_aSounds[a].volume(g),s_aSounds[a].loop(b),s_aSounds[a]):null}function stopSound(a){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].stop()}function setVolume(a,g){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].volume(g)}function setMute(a,g){!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||s_aSounds[a].mute(g)}
function createBitmap(a,g,b){var e=new createjs.Bitmap(a),d=new createjs.Shape;g&&b?d.graphics.beginFill("#fff").drawRect(0,0,g,b):d.graphics.beginFill("#ff0").drawRect(0,0,a.width,a.height);e.hitArea=d;return e}function createSprite(a,g,b,e,d,c){a=null!==g?new createjs.Sprite(a,g):new createjs.Sprite(a);g=new createjs.Shape;g.graphics.beginFill("#000000").drawRect(-b,-e,d,c);a.hitArea=g;return a}function pad(a,g,b){a+="";return a.length>=g?a:Array(g-a.length+1).join(b||"0")+a}
function randomFloatBetween(a,g,b){"undefined"===typeof b&&(b=2);return parseFloat(Math.min(a+Math.random()*(g-a),g).toFixed(b))}function rotateVector2D(a,g){var b=g.getX()*Math.cos(a)+g.getY()*Math.sin(a),e=g.getX()*-Math.sin(a)+g.getY()*Math.cos(a);g.set(b,e)}function tweenVectorsOnX(a,g,b){return a+b*(g-a)}function shuffle(a){for(var g=a.length,b,e;0!==g;)e=Math.floor(Math.random()*g),--g,b=a[g],a[g]=a[e],a[e]=b;return a}
function bubbleSort(a){do{var g=!1;for(var b=0;b<a.length-1;b++)a[b]>a[b+1]&&(g=a[b],a[b]=a[b+1],a[b+1]=g,g=!0)}while(g)}function compare(a,g){return a.index>g.index?-1:a.index<g.index?1:0}function easeLinear(a,g,b,e){return b*a/e+g}function easeInQuad(a,g,b,e){return b*(a/=e)*a+g}function easeInSine(a,g,b,e){return-b*Math.cos(a/e*(Math.PI/2))+b+g}function easeInCubic(a,g,b,e){return b*(a/=e)*a*a+g}function easeInQuart(a,g,b,e){return b*(a/=e)*a*a*a+g}
function easeOutQuart(a,g,b,e){return-b*((a=a/e-1)*a*a*a-1)+g}function getTrajectoryPoint(a,g){var b=new createjs.Point,e=(1-a)*(1-a),d=a*a;b.x=e*g.start.x+2*(1-a)*a*g.traj.x+d*g.end.x;b.y=e*g.start.y+2*(1-a)*a*g.traj.y+d*g.end.y;return b}function formatTime(a){a/=1E3;var g=Math.floor(a/60);a=parseFloat(a-60*g).toFixed(1);var b="";b=10>g?b+("0"+g+":"):b+(g+":");return 10>a?b+("0"+a):b+a}
function angleBetweenVector2D(a,g){var b=Math.acos(dotProductV2(a,g)/(a.length()*g.length()));return 1==isNaN(b)?0:b}function dotProductV2(a,g){return a.getX()*g.getX()+a.getY()*g.getY()}function radiansToDegree(a){return 180/Math.PI*a}function degreesToRadians(a){return a*Math.PI/180}function checkRectCollision(a,g){var b=getBounds(a,.9);var e=getBounds(g,.98);return calculateIntersection(b,e)}
function calculateIntersection(a,g){var b,e,d,c;var f=a.x+(b=a.width/2);var h=a.y+(e=a.height/2);var k=g.x+(d=g.width/2);var l=g.y+(c=g.height/2);f=Math.abs(f-k)-(b+d);h=Math.abs(h-l)-(e+c);return 0>f&&0>h?(f=Math.min(Math.min(a.width,g.width),-f),h=Math.min(Math.min(a.height,g.height),-h),{x:Math.max(a.x,g.x),y:Math.max(a.y,g.y),width:f,height:h,rect1:a,rect2:g}):null}
function getBounds(a,g){var b={x:Infinity,y:Infinity,width:0,height:0};if(a instanceof createjs.Container){b.x2=-Infinity;b.y2=-Infinity;var e=a.children,d=e.length,c;for(c=0;c<d;c++){var f=getBounds(e[c],1);f.x<b.x&&(b.x=f.x);f.y<b.y&&(b.y=f.y);f.x+f.width>b.x2&&(b.x2=f.x+f.width);f.y+f.height>b.y2&&(b.y2=f.y+f.height)}Infinity==b.x&&(b.x=0);Infinity==b.y&&(b.y=0);Infinity==b.x2&&(b.x2=0);Infinity==b.y2&&(b.y2=0);b.width=b.x2-b.x;b.height=b.y2-b.y;delete b.x2;delete b.y2}else{if(a instanceof createjs.Bitmap){d=
a.sourceRect||a.image;c=d.width*g;var h=d.height*g}else if(a instanceof createjs.Sprite)if(a.spriteSheet._frames&&a.spriteSheet._frames[a.currentFrame]&&a.spriteSheet._frames[a.currentFrame].image){d=a.spriteSheet.getFrame(a.currentFrame);c=d.rect.width;h=d.rect.height;e=d.regX;var k=d.regY}else b.x=a.x||0,b.y=a.y||0;else b.x=a.x||0,b.y=a.y||0;e=e||0;c=c||0;k=k||0;h=h||0;b.regX=e;b.regY=k;d=a.localToGlobal(0-e,0-k);f=a.localToGlobal(c-e,h-k);c=a.localToGlobal(c-e,0-k);e=a.localToGlobal(0-e,h-k);b.x=
Math.min(Math.min(Math.min(d.x,f.x),c.x),e.x);b.y=Math.min(Math.min(Math.min(d.y,f.y),c.y),e.y);b.width=Math.max(Math.max(Math.max(d.x,f.x),c.x),e.x)-b.x;b.height=Math.max(Math.max(Math.max(d.y,f.y),c.y),e.y)-b.y}return b}function NoClickDelay(a){this.element=a;window.Touch&&this.element.addEventListener("touchstart",this,!1)}function shuffle(a){for(var g=a.length,b,e;0<g;)e=Math.floor(Math.random()*g),g--,b=a[g],a[g]=a[e],a[e]=b;return a}
NoClickDelay.prototype={handleEvent:function(a){switch(a.type){case "touchstart":this.onTouchStart(a);break;case "touchmove":this.onTouchMove(a);break;case "touchend":this.onTouchEnd(a)}},onTouchStart:function(a){a.preventDefault();this.moved=!1;this.element.addEventListener("touchmove",this,!1);this.element.addEventListener("touchend",this,!1)},onTouchMove:function(a){this.moved=!0},onTouchEnd:function(a){this.element.removeEventListener("touchmove",this,!1);this.element.removeEventListener("touchend",
this,!1);if(!this.moved){a=document.elementFromPoint(a.changedTouches[0].clientX,a.changedTouches[0].clientY);3==a.nodeType&&(a=a.parentNode);var g=document.createEvent("MouseEvents");g.initEvent("click",!0,!0);a.dispatchEvent(g)}}};
(function(){function a(b){var e={focus:"visible",focusin:"visible",pageshow:"visible",blur:"hidden",focusout:"hidden",pagehide:"hidden"};b=b||window.event;b.type in e?document.body.className=e[b.type]:(document.body.className=this[g]?"hidden":"visible","hidden"===document.body.className?(true):(s_oMain.startUpdate(),s_bFocus=!0))}var g="hidden";g in document?document.addEventListener("visibilitychange",a):(g="mozHidden")in document?document.addEventListener("mozvisibilitychange",
a):(g="webkitHidden")in document?document.addEventListener("webkitvisibilitychange",a):(g="msHidden")in document?document.addEventListener("msvisibilitychange",a):"onfocusin"in document?document.onfocusin=document.onfocusout=a:window.onpageshow=window.onpagehide=window.onfocus=window.onblur=a})();function ctlArcadeResume(){null!==s_oMain&&s_oMain.startUpdate()}function ctlArcadePause(){null!==s_oMain&&s_oMain.stopUpdate()}
function getParamValue(a){for(var g=window.location.search.substring(1).split("&"),b=0;b<g.length;b++){var e=g[b].split("=");if(e[0]==a)return e[1]}}String.prototype.format=function(){for(var a=this,g=arguments.length;g--;)a=a.replace(new RegExp("\\{"+g+"\\}","gm"),arguments[g]);return a};function Timer(a,g){var b,e,d=g;this.pause=function(){window.clearTimeout(b);d-=new Date-e};this.resume=function(){e=new Date;window.clearTimeout(b);b=window.setTimeout(a,d)};this.resume()}
function fullscreenHandler(){ENABLE_FULLSCREEN&&screenfull.isEnabled&&(s_bFullscreen=screenfull.isFullscreen,null!==s_oInterface&&s_oInterface.resetFullscreenBut(),null!==s_oMenu&&s_oMenu.resetFullscreenBut())}if(screenfull.isEnabled)screenfull.on("change",function(){s_bFullscreen=screenfull.isFullscreen;null!==s_oInterface&&s_oInterface.resetFullscreenBut();null!==s_oMenu&&s_oMenu.resetFullscreenBut()});
function CSpriteLibrary(){var a={},g,b,e,d,c,f;this.init=function(h,k,l){g={};e=b=0;d=h;c=k;f=l};this.addSprite=function(h,k){if(!a.hasOwnProperty(h)){var l=new Image;a[h]=g[h]={szPath:k,oSprite:l,bLoaded:!1};b++}};this.getSprite=function(h){return a.hasOwnProperty(h)?a[h].oSprite:null};this._onSpritesLoaded=function(){b=0;c.call(f)};this._onSpriteLoaded=function(){d.call(f);++e===b&&this._onSpritesLoaded()};this.loadSprites=function(){for(var h in g)g[h].oSprite.oSpriteLibrary=this,g[h].oSprite.szKey=
h,g[h].oSprite.onload=function(){this.oSpriteLibrary.setLoaded(this.szKey);this.oSpriteLibrary._onSpriteLoaded(this.szKey)},g[h].oSprite.onerror=function(k){var l=k.currentTarget;setTimeout(function(){g[l.szKey].oSprite.src=g[l.szKey].szPath},500)},g[h].oSprite.src=g[h].szPath};this.setLoaded=function(h){a[h].bLoaded=!0};this.isLoaded=function(h){return a[h].bLoaded};this.getNumSprites=function(){return b}}
var SHIP_SMALL={map:[[!0],[!0],[!0]],sandbox_sprite:"ship5",battle_spritesheet:5,index_type:0,reg_points:{x:12,y:24,inverseX:74,inverseY:60},fill_pos:{x:151.5,y:-344.5},enemy_sunk_pos:{x:550,y:-26}},SHIP_SUB={map:[[!0],[!0],[!0],[!0]],sandbox_sprite:"ship4",battle_spritesheet:4,index_type:1,reg_points:{x:10,y:18,inverseX:100,inverseY:74},fill_pos:{x:147.5,y:-413},enemy_sunk_pos:{x:400,y:-26}},SHIP_MEDIUM={map:[[!0],[!0],[!0],[!0]],sandbox_sprite:"ship3",battle_spritesheet:3,index_type:2,reg_points:{x:10,
y:28,inverseX:106,inverseY:86},fill_pos:{x:150,y:-269},enemy_sunk_pos:{x:680,y:-26}},SHIP_LONG={map:[[!0],[!0],[!0],[!0],[!0]],sandbox_sprite:"ship2",battle_spritesheet:2,index_type:3,reg_points:{x:16,y:46,inverseX:134,inverseY:118},fill_pos:{x:151.5,y:-196},enemy_sunk_pos:{x:860,y:-26}},SHIP_BATTLE={map:[[!0],[!0],[!0],[!0],[!0],[!0]],sandbox_sprite:"ship1",battle_spritesheet:1,index_type:4,reg_points:{x:6,y:48,inverseX:166,inverseY:138},fill_pos:{x:149,y:-118.5},enemy_sunk_pos:{x:1060,y:-26}},SHIP_CARRIER=
{map:[[!0,!0],[!0,!0],[!0,!0],[!0,!0],[!0,!0]],sandbox_sprite:"ship0",battle_spritesheet:0,index_type:5,reg_points:{x:14,y:60,inverseX:170,inverseY:112},fill_pos:{x:154,y:-41},enemy_sunk_pos:{x:1280,y:-26}},CANVAS_WIDTH=1920,CANVAS_HEIGHT=1080,EDGEBOARD_X=250,EDGEBOARD_Y=80,PRIMARY_FONT="Arial",SECONDARY_FONT="Montserrat",SOUNDTRACK_VOLUME_IN_GAME=.4,FPS=30,FPS_TIME=1E3/FPS,DISABLE_SOUND_MOBILE=!1,STATE_LOADING=0,STATE_MENU=1,STATE_HELP=1,STATE_GAME=3,ON_MOUSE_DOWN=0,ON_MOUSE_UP=1,ON_MOUSE_OVER=2,
ON_MOUSE_OUT=3,ON_DRAG_START=4,ON_DRAG_END=5,MODE_CLASSIC=0,MODE_ADVANCED=1,PLAYER=0,OPPONENT=1,SHIPS_TYPE=[SHIP_CARRIER,SHIP_BATTLE,SHIP_LONG,SHIP_MEDIUM,SHIP_SUB,SHIP_SMALL],MISSILE_TYPE_NORMAL=0,MISSILE_TYPE_TORPEDO=1,MISSILE_TYPE_AIRSTRIKE=2,SEA_PIECE_DIM=512,NUM_CELL=14,TOT_CELL=196,BOARD_LENGTH=710,BOARD_REG_POINTS={x:237,y:286},CELL_LENGTH=BOARD_LENGTH/NUM_CELL,CONTROL_CELL_DIM=52,CELL_STATE_VOID="void",CELL_STATE_HIT="hit",CELL_STATE_SUNK="sunk",CELL_STATE_WATER="water",AI_STATE_NEW_COORDINATE=
0,AI_STATE_FIND_SHIP_NEIGHBOR=1,AI_FIND_DIRECTION=2,AI_FOLLOW_DIRECTION=3,AI_REVERSE_DIRECTION=4,AI_FOLLOW_REVERSE=5,AI_FOLLOW_CARRIER=6,PREDICT_WATER=0,PREDICT_HIT=1,PREDICT_SUNK=2,COST_AIRSTRIKE=100,COST_RADAR=200,NUM_BOMB_AIRSTRIKE=5,MIN_AI_THINKING=1E3,MAX_AI_THINKING=1500,POINTS_TO_LOSE,POINTS_EARNED,AD_SHOW_COUNTER,ENABLE_FULLSCREEN,ENABLE_CHECK_ORIENTATION;
function CPreloader(){var a,g,b,e,d,c,f,h,k,l;this._init=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("progress_bar","./sprites/progress_bar.png");s_oSpriteLibrary.addSprite("200x200","./sprites/200x200.jpg");s_oSpriteLibrary.addSprite("but_start","./sprites/but_start.png");s_oSpriteLibrary.loadSprites();l=new createjs.Container;s_oStage.addChild(l)};this.unload=function(){l.removeAllChildren();k.unload()};this._onImagesLoaded=function(){};
this._onAllImagesLoaded=function(){this.attachSprites();s_oMain.preloaderReady()};this.attachSprites=function(){var m=new createjs.Shape;m.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.addChild(m);m=s_oSpriteLibrary.getSprite("200x200");f=createBitmap(m);f.regX=.5*m.width;f.regY=.5*m.height;f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2-180;l.addChild(f);h=new createjs.Shape;h.graphics.beginFill("rgba(0,0,0,0.01)").drawRoundRect(f.x-100,f.y-100,200,200,10);l.addChild(h);f.mask=h;
m=s_oSpriteLibrary.getSprite("progress_bar");e=createBitmap(m);e.x=CANVAS_WIDTH/2-m.width/2;e.y=CANVAS_HEIGHT/2+50;l.addChild(e);a=m.width;g=m.height;d=new createjs.Shape;d.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(e.x,e.y,1,g);l.addChild(d);e.mask=d;b=new createjs.Text("","30px "+PRIMARY_FONT,"#fff");b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2+100;b.textBaseline="alphabetic";b.textAlign="center";l.addChild(b);m=s_oSpriteLibrary.getSprite("but_start");k=new CTextButton(CANVAS_WIDTH/2,CANVAS_HEIGHT/
2,m,TEXT_PRELOADER_CONTINUE,"Arial","#000","bold 40",l);k.addEventListener(ON_MOUSE_UP,this._onButStartRelease,this);k.setVisible(!1);c=new createjs.Shape;c.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);l.addChild(c);createjs.Tween.get(c).to({alpha:0},500).call(function(){createjs.Tween.removeTweens(c);l.removeChild(c)})};this._onButStartRelease=function(){$(s_oMain).trigger("show_preroll_ad");s_oMain._onPreloaderComplete()};this.refreshLoader=function(m){b.text=m+"%";100===
m&&($(s_oMain).trigger("show_preroll_ad"),s_oMain._onPreloaderComplete(),b.visible=!1,e.visible=!1);d.graphics.clear();m=Math.floor(m*a/100);d.graphics.beginFill("rgba(0,0,0,0.01)").drawRect(e.x,e.y,m,g)};this._init()}
function CMain(a){var g,b=0,e=0,d=STATE_LOADING,c,f;this.initContainer=function(){s_oCanvas=document.getElementById("canvas");s_oStage=new createjs.Stage(s_oCanvas);s_oStage.preventSelection=!0;createjs.Touch.enable(s_oStage,!0);s_bMobile=isMobile();!1===s_bMobile&&s_oStage.enableMouseOver(FPS);s_iPrevTime=(new Date).getTime();createjs.Ticker.addEventListener("tick",this._update);createjs.Ticker.framerate=FPS;navigator.userAgent.match(/Windows Phone/i)&&(DISABLE_SOUND_MOBILE=!0);s_oSpriteLibrary=
new CSpriteLibrary;c=new CPreloader};this.preloaderReady=function(){this._loadImages();!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||this._initSounds();g=!0};this.soundLoaded=function(k){b++;c.refreshLoader(Math.floor(b/e*100))};this._initSounds=function(){Howler.mute(!s_bAudioActive);s_aSoundsInfo=[];s_aSoundsInfo.push({path:"./sounds/",filename:"soundtrack",loop:!0,volume:1,ingamename:"soundtrack"});s_aSoundsInfo.push({path:"./sounds/",filename:"click",loop:!1,volume:1,ingamename:"click"});s_aSoundsInfo.push({path:"./sounds/",
filename:"game_over",loop:!1,volume:1,ingamename:"game_over"});s_aSoundsInfo.push({path:"./sounds/",filename:"missile_explosion",loop:!1,volume:1,ingamename:"missile_explosion"});s_aSoundsInfo.push({path:"./sounds/",filename:"missile_launch",loop:!1,volume:1,ingamename:"missile_launch"});s_aSoundsInfo.push({path:"./sounds/",filename:"missile_sink",loop:!1,volume:1,ingamename:"missile_sink"});s_aSoundsInfo.push({path:"./sounds/",filename:"missile_torpedo",loop:!1,volume:1,ingamename:"missile_torpedo"});
s_aSoundsInfo.push({path:"./sounds/",filename:"missile_water",loop:!1,volume:1,ingamename:"missile_water"});s_aSoundsInfo.push({path:"./sounds/",filename:"air_strike",loop:!1,volume:1,ingamename:"air_strike"});s_aSoundsInfo.push({path:"./sounds/",filename:"sonar",loop:!1,volume:1,ingamename:"sonar"});e+=s_aSoundsInfo.length;s_aSounds=[];for(var k=0;k<s_aSoundsInfo.length;k++)this.tryToLoadSound(s_aSoundsInfo[k],!1)};this.tryToLoadSound=function(k,l){setTimeout(function(){s_aSounds[k.ingamename]=new Howl({src:[k.path+
k.filename+".mp3"],autoplay:!1,preload:!0,loop:k.loop,volume:k.volume,onload:s_oMain.soundLoaded,onloaderror:function(m,n){for(var p=0;p<s_aSoundsInfo.length;p++)if(m===s_aSounds[s_aSoundsInfo[p].ingamename]._sounds[0]._id){s_oMain.tryToLoadSound(s_aSoundsInfo[p],!0);break}},onplayerror:function(m){for(var n=0;n<s_aSoundsInfo.length;n++)if(m===s_aSounds[s_aSoundsInfo[n].ingamename]._sounds[0]._id){s_aSounds[s_aSoundsInfo[n].ingamename].once("unlock",function(){s_aSounds[s_aSoundsInfo[n].ingamename].play();
"soundtrack"===s_aSoundsInfo[n].ingamename&&null!==s_oGame&&setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME)});break}}})},l?200:0)};this._loadImages=function(){s_oSpriteLibrary.init(this._onImagesLoaded,this._onAllImagesLoaded,this);s_oSpriteLibrary.addSprite("but_play","./sprites/but_play.png");s_oSpriteLibrary.addSprite("msg_box","./sprites/msg_box.png");s_oSpriteLibrary.addSprite("ctl_logo","./sprites/ctl_logo.png");s_oSpriteLibrary.addSprite("but_info","./sprites/but_info.png");s_oSpriteLibrary.addSprite("but_yes",
"./sprites/but_yes.png");s_oSpriteLibrary.addSprite("but_not","./sprites/but_not.png");s_oSpriteLibrary.addSprite("but_shuffle","./sprites/but_shuffle.png");s_oSpriteLibrary.addSprite("but_delete","./sprites/but_delete.png");s_oSpriteLibrary.addSprite("but_rotate","./sprites/but_rotate.png");s_oSpriteLibrary.addSprite("but_classic","./sprites/but_classic.png");s_oSpriteLibrary.addSprite("but_advanced","./sprites/but_advanced.png");s_oSpriteLibrary.addSprite("but_help","./sprites/but_help.png");s_oSpriteLibrary.addSprite("bg_sandbox_menu",
"./sprites/bg_sandbox_menu.jpg");s_oSpriteLibrary.addSprite("bg_menu","./sprites/bg_menu.jpg");s_oSpriteLibrary.addSprite("bg_mode","./sprites/bg_mode.jpg");s_oSpriteLibrary.addSprite("score_panel","./sprites/score_panel.png");s_oSpriteLibrary.addSprite("but_exit","./sprites/but_exit.png");s_oSpriteLibrary.addSprite("audio_icon","./sprites/audio_icon.png");s_oSpriteLibrary.addSprite("but_fullscreen","./sprites/but_fullscreen.png");s_oSpriteLibrary.addSprite("highlight","./sprites/highlight.png");
s_oSpriteLibrary.addSprite("occupied_area","./sprites/occupied_area.png");s_oSpriteLibrary.addSprite("control_panel","./sprites/control_panel.png");s_oSpriteLibrary.addSprite("cell_control","./sprites/cell_control.png");s_oSpriteLibrary.addSprite("cell_battle","./sprites/cell_battle.png");for(var k=0;6>k;k++)s_oSpriteLibrary.addSprite("fill_"+k,"./sprites/ships/fill_"+k+".png"),s_oSpriteLibrary.addSprite("shape_"+k,"./sprites/ships/shape_"+k+".png"),s_oSpriteLibrary.addSprite("ship"+k,"./sprites/ships/ship"+
k+".png"),s_oSpriteLibrary.addSprite("ship"+k+"_3d","./sprites/ships/ship"+k+"_3d.png");s_oSpriteLibrary.addSprite("final_explosion","./sprites/final_explosion.png");s_oSpriteLibrary.addSprite("torpedo","./sprites/torpedo.png");s_oSpriteLibrary.addSprite("missile","./sprites/missile.png");s_oSpriteLibrary.addSprite("missile_reactor","./sprites/missile_reactor.png");s_oSpriteLibrary.addSprite("missile_smoke","./sprites/missile_smoke.png");s_oSpriteLibrary.addSprite("missile_water","./sprites/missile_water.png");
s_oSpriteLibrary.addSprite("missile_explosion","./sprites/missile_explosion.png");s_oSpriteLibrary.addSprite("fire","./sprites/fire.png");for(k=0;37>=k;k++)s_oSpriteLibrary.addSprite("surface_"+k,"./sprites/sea_caustics/surface_"+k+".jpg");s_oSpriteLibrary.addSprite("bg_rocks","./sprites/bg_rocks.png");s_oSpriteLibrary.addSprite("enemy_fleet_panel","./sprites/enemy_fleet_panel.png");s_oSpriteLibrary.addSprite("your_fleet_panel","./sprites/your_fleet_panel.png");s_oSpriteLibrary.addSprite("wait_player",
"./sprites/wait_player.png");s_oSpriteLibrary.addSprite("but_air_strike","./sprites/but_air_strike.png");s_oSpriteLibrary.addSprite("but_radar","./sprites/but_radar.png");s_oSpriteLibrary.addSprite("air","./sprites/air.png");s_oSpriteLibrary.addSprite("air_shadow","./sprites/air_shadow.png");s_oSpriteLibrary.addSprite("sea_mobile","./sprites/sea_mobile.jpg");e+=s_oSpriteLibrary.getNumSprites();s_oSpriteLibrary.loadSprites()};this._onImagesLoaded=function(){b++;c.refreshLoader(Math.floor(b/e*100))};
this._onAllImagesLoaded=function(){};this._onPreloaderComplete=function(){c.unload();s_oSoundtrack=playSound("soundtrack",1,!0);this.gotoMenu();new CAnimationSettings};this.gotoMenu=function(){new CMenu;d=STATE_MENU};this.gotoModeMenu=function(){new CModeMenu;d=STATE_MENU};this.gotoSandBoxMenu=function(){new CSandBoxMenu;d=STATE_MENU};this.gotoGame=function(k){f=new CGame(h,k);d=STATE_GAME};this.gotoHelp=function(){new CHelp;d=STATE_HELP};this.stopUpdate=function(){g=!1;createjs.Ticker.paused=!0;
$("#block_game").css("display","block");!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||Howler.mute(!0)};this.startUpdate=function(){s_iPrevTime=(new Date).getTime();g=!0;createjs.Ticker.paused=!1;$("#block_game").css("display","none");(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)&&s_bAudioActive&&Howler.mute(!1)};this._update=function(k){if(!1!==g){var l=(new Date).getTime();s_iTimeElaps=l-s_iPrevTime;s_iCntTime+=s_iTimeElaps;s_iCntFps++;s_iPrevTime=l;1E3<=s_iCntTime&&(s_iCurFps=s_iCntFps,s_iCntTime-=1E3,
s_iCntFps=0);d===STATE_GAME&&f.update();s_oStage.update(k)}};s_oMain=this;var h=a;ENABLE_FULLSCREEN=a.fullscreen;ENABLE_CHECK_ORIENTATION=a.check_orientation;s_bAudioActive=a.audio_enable_on_startup;this.initContainer()}var s_bMobile,s_bAudioActive=!1,s_iCntTime=0,s_iTimeElaps=0,s_iPrevTime=0,s_iCntFps=0,s_iCurFps=0,s_bFullscreen=!1,s_iMode,s_oDrawLayer,s_oStage,s_oMain,s_oSpriteLibrary,s_oSoundtrack,s_oCanvas,s_aSounds,s_aSoundsInfo;
function CTextButton(a,g,b,e,d,c,f,h){var k,l,m,n,p,q,r;this._init=function(t,u,F,w,y,A,x,B){k=[];l=[];var I=createBitmap(F),z=Math.ceil(x/20);p=new createjs.Text(w," "+x+"px "+y,"#000000");p.textAlign="center";p.textBaseline="alphabetic";var H=p.getBounds();p.x=F.width/2+z;p.y=Math.floor(F.height/2)+H.height/3+z;n=new createjs.Text(w," "+x+"px "+y,A);n.textAlign="center";n.textBaseline="alphabetic";H=n.getBounds();n.x=F.width/2;n.y=Math.floor(F.height/2)+H.height/3;m=new createjs.Container;m.x=t;
m.y=u;m.regX=F.width/2;m.regY=F.height/2;m.addChild(I,p,n);B.addChild(m);this._initListener()};this.unload=function(){m.off("mousedown",q);m.off("pressup",r);h.removeChild(m)};this.setVisible=function(t){m.visible=t};this._initListener=function(){oParent=this;q=m.on("mousedown",this.buttonDown);r=m.on("pressup",this.buttonRelease)};this.addEventListener=function(t,u,F){k[t]=u;l[t]=F};this.buttonRelease=function(){m.scaleX=1;m.scaleY=1;k[ON_MOUSE_UP]&&k[ON_MOUSE_UP].call(l[ON_MOUSE_UP])};this.buttonDown=
function(){m.scaleX=.9;m.scaleY=.9;k[ON_MOUSE_DOWN]&&k[ON_MOUSE_DOWN].call(l[ON_MOUSE_DOWN])};this.setTextPosition=function(t){n.y=t;p.y=t+2};this.setPosition=function(t,u){m.x=t;m.y=u};this.setX=function(t){m.x=t};this.setY=function(t){m.y=t};this.getButtonImage=function(){return m};this.getX=function(){return m.x};this.getY=function(){return m.y};this._init(a,g,b,e,d,c,f,h);return this}
function CToggle(a,g,b,e,d){var c,f,h,k,l,m,n,p,q;this._init=function(r,t,u,F,w){f=!1;n=[];p=[];var y=new createjs.SpriteSheet({images:[u],frames:{width:u.width/2,height:u.height,regX:u.width/2/2,regY:u.height/2},animations:{state_true:[0],state_false:[1]}});c=F;q=createSprite(y,"state_"+c,u.width/2/2,u.height/2,u.width/2,u.height);q.x=r;q.y=t;q.stop();w.addChild(q);this._initListener()};this.setVisible=function(r){q.visible=r};this.unload=function(){s_bMobile?q.off("mousedown",h):(q.off("mousedown",
h),q.off("mouseover",l),q.off("mouseout",m));q.off("pressup",k);d.removeChild(q)};this._initListener=function(){s_bMobile?h=q.on("mousedown",this.buttonDown):(h=q.on("mousedown",this.buttonDown),l=q.on("mouseover",this.buttonOver),m=q.on("mouseout",this.buttonOut));k=q.on("pressup",this.buttonRelease)};this.addEventListener=function(r,t,u){n[r]=t;p[r]=u};this.setActive=function(r){c=r;q.gotoAndStop("state_"+c)};this.buttonRelease=function(){f||(q.scaleX=1,q.scaleY=1,playSound("click",1,!1),c=!c,q.gotoAndStop("state_"+
c),n[ON_MOUSE_UP]&&n[ON_MOUSE_UP].call(p[ON_MOUSE_UP],c))};this.buttonDown=function(){f||(q.scaleX=.9,q.scaleY=.9,n[ON_MOUSE_DOWN]&&n[ON_MOUSE_DOWN].call(p[ON_MOUSE_DOWN]))};this.buttonOver=function(r){s_bMobile||f||(r.target.cursor="pointer",n[ON_MOUSE_OVER]&&n[ON_MOUSE_OVER].call(p[ON_MOUSE_OVER]))};this.buttonOut=function(r){s_bMobile||f||(r.target.cursor="pointer",n[ON_MOUSE_OUT]&&n[ON_MOUSE_OUT].call(p[ON_MOUSE_OUT]))};this.setPosition=function(r,t){q.x=r;q.y=t};this.getPos=function(){return{x:q.x,
y:q.y}};this.setClickable=function(r){f=!r};this.enable=function(r){r?(q.gotoAndPlay("state_true"),this.setClickable(!0)):(q.gotoAndPlay("state_false"),this.setClickable(!1))};this._init(a,g,b,e,d)}
function CGfxButton(a,g,b,e){var d,c,f,h,k,l,m,n,p;this._init=function(q,r,t,u){d=!1;c=1;m=[];n=[];p=new createjs.Container;p.x=q;p.y=r;u.addChild(p);q=createBitmap(t);q.scaleX=p.scaleY=c;q.regX=t.width/2;q.regY=t.height/2;p.addChild(q);this._initListener()};this.unload=function(){s_bMobile?p.off("mousedown",f):(p.off("mousedown",f),p.off("mouseover",k),p.off("mouseout",l));p.off("pressup",h);e.removeChild(p)};this.setVisible=function(q){p.visible=q};this.setClickable=function(q){d=!q};this._initListener=
function(){s_bMobile?f=p.on("mousedown",this.buttonDown):(f=p.on("mousedown",this.buttonDown),k=p.on("mouseover",this.buttonOver),l=p.on("mouseout",this.buttonOut));h=p.on("pressup",this.buttonRelease)};this.addEventListener=function(q,r,t){m[q]=r;n[q]=t};this.buttonRelease=function(){d||(p.scaleX=c,p.scaleY=c,m[ON_MOUSE_UP]&&m[ON_MOUSE_UP].call(n[ON_MOUSE_UP]))};this.buttonDown=function(){d||(p.scaleX=.9*c,p.scaleY=.9*c,playSound("click",1,!1),m[ON_MOUSE_DOWN]&&m[ON_MOUSE_DOWN].call(n[ON_MOUSE_DOWN]))};
this.buttonOver=function(q){s_bMobile||d||(q.target.cursor="pointer")};this.buttonOut=function(q){s_bMobile||d||(q.target.cursor="pointer",m[ON_MOUSE_OUT]&&m[ON_MOUSE_OUT].call(n[ON_MOUSE_OUT]))};this.pulseAnimation=function(){createjs.Tween.get(p,{loop:!0}).to({scaleX:.9*c,scaleY:.9*c},850,createjs.Ease.quadOut).to({scaleX:c,scaleY:c},650,createjs.Ease.quadIn)};this.trembleAnimation=function(){createjs.Tween.get(p,{loop:!0}).to({rotation:5},75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},
75,createjs.Ease.quadIn).wait(750)};this.setPosition=function(q,r){p.x=q;p.y=r};this.setX=function(q){p.x=q};this.setY=function(q){p.y=q};this.getButtonImage=function(){return p};this.getX=function(){return p.x};this.getY=function(){return p.y};this.setText=function(q,r,t){var u=b.width-80;new CTLText(p,r-u/2,t-22,u,44,44,"center","#1ef400",SECONDARY_FONT,1,2,2,q,!0,!0,!1,!1)};this._init(a,g,b,e);return this}
function CMenu(){var a,g,b,e,d,c,f,h,k,l,m,n,p=null,q=null;this._init=function(){f=createBitmap(s_oSpriteLibrary.getSprite("bg_menu"));s_oStage.addChild(f);var r=s_oSpriteLibrary.getSprite("but_play");h=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-300,r,s_oStage);h.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);h.pulseAnimation();r=s_oSpriteLibrary.getSprite("but_info");d=r.height/2+10;c=r.height/2+10;m=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-240,r,s_oStage);m.addEventListener(ON_MOUSE_UP,
this._onCreditsBut,this);if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)r=s_oSpriteLibrary.getSprite("audio_icon"),b=CANVAS_WIDTH-r.height/2-10,e=r.height/2+10,l=new CToggle(b,e,r,s_bAudioActive,s_oStage),l.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);r=window.document;var t=r.documentElement;p=t.requestFullscreen||t.mozRequestFullScreen||t.webkitRequestFullScreen||t.msRequestFullscreen;q=r.exitFullscreen||r.mozCancelFullScreen||r.webkitExitFullscreen||r.msExitFullscreen;!1===ENABLE_FULLSCREEN&&
(p=!1);p&&screenfull.isEnabled&&(r=s_oSpriteLibrary.getSprite("but_fullscreen"),a=d+r.width/2+10,g=r.height/2+10,n=new CToggle(a,g,r,s_bFullscreen,s_oStage),n.addEventListener(ON_MOUSE_UP,this._onFullscreen,this));k=new createjs.Shape;k.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(k);createjs.Tween.get(k).to({alpha:0},1E3).call(function(){k.visible=!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){h.unload();h=null;k.visible=!1;m.unload();
if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)l.unload(),l=null;p&&screenfull.isEnabled&&n.unload();s_oStage.removeChild(f);s_oMenu=f=null};this.refreshButtonPos=function(r,t){m.setPosition(d+r,t+c);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||l.setPosition(b-r,t+e);p&&screenfull.isEnabled&&n.setPosition(a+r,g+t)};this.resetFullscreenBut=function(){p&&screenfull.isEnabled&&n.setActive(s_bFullscreen)};this._onFullscreen=function(){s_bFullscreen?q.call(window.document):p.call(window.document.documentElement);
sizeHandler()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onCreditsBut=function(){new CCreditsPanel};this._onButPlayRelease=function(){this.unload();$(s_oMain).trigger("start_session");s_oMain.gotoModeMenu()};s_oMenu=this;this._init()}var s_oMenu=null;
function CModeMenu(){var a,g,b,e,d,c,f,h,k,l,m,n;this._init=function(){var q=createBitmap(s_oSpriteLibrary.getSprite("bg_mode"));s_oStage.addChild(q);new CTLText(s_oStage,CANVAS_WIDTH/2-500,180,1E3,160,160,"center","#1ef400",SECONDARY_FONT,1,2,2,TEXT_GAME_MODE,!0,!0,!1,!1);q=s_oSpriteLibrary.getSprite("but_classic");h=new CGfxButton(CANVAS_WIDTH/2-220,CANVAS_HEIGHT/2+100,q,s_oStage);h.addEventListener(ON_MOUSE_UP,this._onClassicBut,this);h.setText(TEXT_CLASSIC,0,76);q=s_oSpriteLibrary.getSprite("but_advanced");
k=new CGfxButton(CANVAS_WIDTH/2+220,CANVAS_HEIGHT/2+100,q,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onAdvancedBut,this);k.setText(TEXT_ADVANCED,0,76);q=s_oSpriteLibrary.getSprite("but_help");a=q.height/2+10;g=q.height/2+10;n=new CGfxButton(CANVAS_WIDTH/2,CANVAS_HEIGHT-240,q,s_oStage);n.addEventListener(ON_MOUSE_UP,this._onHelpBut,this);q=s_oSpriteLibrary.getSprite("but_exit");d=CANVAS_WIDTH-q.height/2-10;c=q.height/2+10;l=new CGfxButton(d,c,q,s_oStage);l.addEventListener(ON_MOUSE_UP,this._onExit,
this);b=CANVAS_WIDTH-q.width/2-110;e=q.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)q=s_oSpriteLibrary.getSprite("audio_icon"),m=new CToggle(b,e,q,s_bAudioActive,s_oStage),m.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);f=new createjs.Shape;f.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(f);createjs.Tween.get(f).to({alpha:0},1E3).call(function(){f.visible=!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){s_oStage.removeAllChildren();
k.unload();h.unload();l.unload();m.unload();n.unload();s_oModeMenu=null};this.refreshButtonPos=function(q,r){n.setPosition(a+q,r+g);l.setPosition(d-q,r+c);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||m.setPosition(b-q,r+e)};this._onHelpBut=function(){new CHelpPanel};this._onExit=function(){this.unload();s_oMain.gotoMenu()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onClassicBut=function(){p.unload();s_iMode=MODE_CLASSIC;s_oMain.gotoSandBoxMenu()};
this._onAdvancedBut=function(){p.unload();s_iMode=MODE_ADVANCED;s_oMain.gotoSandBoxMenu()};s_oModeMenu=this;var p=this;this._init()}var s_oModeMenu=null;
function CGame(a,g){var b,e,d,c,f=0,h,k,l,m,n=null,p,q,r,t,u,F,w,y,A,x,B,I,z,H;this._init=function(){setVolume("soundtrack",SOUNDTRACK_VOLUME_IN_GAME);$(s_oMain).trigger("start_level",1);b=!0;e=0;c=PLAYER;h=0;d=1;F=new CBackground(s_oStage);w=new createjs.Container;s_oStage.addChild(w);l=g;this._initEnemyBoard();y=new createjs.Container;s_oStage.addChild(y);A=new createjs.Container;s_oStage.addChild(A);q=new CPlayerBoard(CANVAS_WIDTH/2-150,CANVAS_HEIGHT/2+100,y,l,PLAYER,A);r=new CPlayerBoard(CANVAS_WIDTH/
2+150,CANVAS_HEIGHT/2-200,y,k,OPPONENT,A);t=new CMissile(A,w);I=new CTurnWaiter(s_oStage);u=null;z=new CAirStrike(y);m=new CInterface;m.refreshScore(e);if(!s_bMobile)s_oStage.on("stagemousemove",this.setMouseCoordinate);p=new CControlPanel;p.show();x=new CAI(q);B=new createjs.Shape;B.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(B);createjs.Tween.get(B).to({alpha:0},1E3).call(function(){B.visible=!1})};this._initEnemyBoard=function(){var C=new CSandBoxBoard(0,
0,s_oStage,!1);k=[];k[0]=new CShip(400,200,SHIP_SMALL,s_oStage,C);k[1]=new CShip(400,300,SHIP_SUB,s_oStage,C);k[2]=new CShip(400,400,SHIP_MEDIUM,s_oStage,C);k[3]=new CShip(400,500,SHIP_LONG,s_oStage,C);k[4]=new CShip(400,600,SHIP_BATTLE,s_oStage,C);k[5]=new CShip(400,700,SHIP_CARRIER,s_oStage,C);C.shuffle(k);for(var G=0;G<k.length;G++)k[G].unload();C.unload()};this.tryShowAd=function(){f++;f===AD_SHOW_COUNTER&&(f=0,$(s_oMain).trigger("show_interlevel_ad"))};this.onCellClick=function(C,G){p.hide();
h=1;t.launchMissileForPlayer(C,G)};this.onMissileArrived=function(C,G){var M=[r,q],O=M[c].isShipOn(C,G);if(null!==O){if(O.hitShip(C,G),M[c].setCellState(C,G,CELL_STATE_HIT),c===OPPONENT?(M[c].setFire(C,G),s_oGame.addScore(-POINTS_TO_LOSE)):(s_oGame.addScore(d*POINTS_EARNED),d++),M[c].playExplosion(C,G),O.isSunk()){for(var V=O.getListCellOccupied(),T=0;T<V.length;T++)for(var X=s_oBoardUtility.getAllNeighbor(V[T].row,V[T].col),R=0;R<X.length;R++)M[c].setCellState(X[R].row,X[R].col,CELL_STATE_WATER);
for(T=0;T<V.length;T++)M[c].setCellState(V[T].row,V[T].col,CELL_STATE_SUNK);c===OPPONENT&&x.resetToStartState();M[c].sunkAnimation(O)}}else M[c].setCellState(C,G,CELL_STATE_WATER),M[c].playWater(C,G),c===PLAYER&&(d=1);p.refresh(r.getCells());c===OPPONENT?m.setShipDamage(l):m.setEnemySunk(k);h--;0===h&&(this.tryShowAd(),this.changeTurn())};this.changeTurn=function(){this.checkEndGame()||(c===PLAYER?(c=OPPONENT,this._wakeUpAI()):(c=PLAYER,setTimeout(function(){p.show()},1E3)))};this._wakeUpAI=function(){I.show();
h=1;var C=randomFloatBetween(MIN_AI_THINKING,MAX_AI_THINKING),G;u=new Timer(function(){G=x.getCoordinate(l);t.launchMissileForOpponent(G.row,G.col);I.hide();u=null},C)};this.checkEndGame=function(){for(var C=!0,G=0;G<k.length;G++)if(!k[G].isSunk()){C=!1;break}var M=!0;for(G=0;G<l.length;G++)if(!l[G].isSunk()){M=!1;break}C?this.gameOver(PLAYER):M&&this.gameOver(OPPONENT);return C||M};this.setNumMissileShot=function(C){h=C};this.getRandomAvailableShip=function(C){for(var G=[l,k],M=[],O=0;O<G[C].length;O++)G[C][O].isSunk()||
M.push(G[C][O]);return M[Math.floor(Math.random()*M.length)]};this.getCellPos=function(C,G,M){return M===OPPONENT?r.getCellPos(C,G):q.getCellPos(C,G)};this.getBoardPos=function(C){if(C===PLAYER)return q.getPos();C=r.getBounds();var G=r.getPos();return{x:G.x-C.width/2,y:G.y}};this.getBoard=function(C){return C===PLAYER?q:r};this.launchAirStrike=function(){z.launch()};this.addScore=function(C){e+=C;0>=e&&(e=0);m.refreshScore(e)};this.getScore=function(){return e};this.restartGame=function(){$(s_oMain).trigger("show_interlevel_ad");
this.unload();this._init()};this.pauseGame=function(C){b=!C;null!==u&&(b?u.resume():u.pause())};this.unload=function(){b=!1;m.unload();null!==n&&n.unload();createjs.Tween.removeAllTweens();s_oStage.removeAllChildren()};this.onExit=function(){$(s_oMain).trigger("end_session");s_oGame.unload();s_oMain.gotoMenu()};this._onExitHelp=function(){b=!0;$(s_oMain).trigger("start_level",1)};this.gameOver=function(C){n=new CEndPanel(C);n.show(e)};this.setMouseCoordinate=function(C){H={x:C.stageX,y:C.stageY}};
this.getMouseCoordinate=function(){return H};this.update=function(){b&&(null!==I&&I.update(),t.update(),F.update(),p.update(H))};s_oGame=this;POINTS_TO_LOSE=a.points_to_lose;POINTS_EARNED=a.points_earned;AD_SHOW_COUNTER=a.ad_show_counter;this._init()}var s_oGame;
function CInterface(){var a,g,b,e,d,c,f,h,k,l,m,n=null,p,q=null,r=null;this._init=function(){var t=s_oSpriteLibrary.getSprite("but_exit");f=CANVAS_WIDTH-t.height/2-10;h=t.height/2+10;l=new CGfxButton(f,h,t,s_oStage);l.addEventListener(ON_MOUSE_UP,this._onExit,this);d=CANVAS_WIDTH-t.width/2-110;c=t.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)t=s_oSpriteLibrary.getSprite("audio_icon"),k=new CToggle(d,c,t,s_bAudioActive,s_oStage),k.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);
t=window.document;var u=t.documentElement;q=u.requestFullscreen||u.mozRequestFullScreen||u.webkitRequestFullScreen||u.msRequestFullscreen;r=t.exitFullscreen||t.mozCancelFullScreen||t.webkitExitFullscreen||t.msExitFullscreen;!1===ENABLE_FULLSCREEN&&(q=!1);q&&screenfull.isEnabled&&(t=s_oSpriteLibrary.getSprite("but_fullscreen"),b=t.width/4+10,e=t.height/2+10,m=new CToggle(b,e,t,s_bFullscreen,s_oStage),m.addEventListener(ON_MOUSE_UP,this._onFullscreen,this));a=0;g=CANVAS_HEIGHT;p=new CSummaryPanel(a,
g,s_oStage);this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.unload=function(){if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)k.unload(),k=null;l.unload();q&&screenfull.isEnabled&&m.unload();s_oInterface=null};this.refreshButtonPos=function(t,u){l.setPosition(f-t,u+h);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||k.setPosition(d-t,u+c);q&&screenfull.isEnabled&&m.setPosition(b+t,e+u);p.setPos(a+t,g-u)};this.refreshScore=function(t){p.setScore(t)};this.setShipDamage=function(t){p.setDamage(t)};this.setEnemySunk=
function(t){p.setEnemySunk(t)};this._onButHelpRelease=function(){n=new CHelpPanel};this.onExitFromHelp=function(){n.unload()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};this._onExit=function(){new CAreYouSurePanel(s_oGame.onExit)};this.resetFullscreenBut=function(){q&&screenfull.isEnabled&&m.setActive(s_bFullscreen)};this._onFullscreen=function(){s_bFullscreen?r.call(window.document):q.call(window.document.documentElement);sizeHandler()};s_oInterface=
this;this._init();return this}var s_oInterface=null;
function CHelpPanel(){var a,g,b,e,d,c;this._init=function(){b=new createjs.Shape;b.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);b.alpha=0;g=b.on("mousedown",this.unload);s_oStage.addChild(b);(new createjs.Tween.get(b)).to({alpha:.7},500);e=new createjs.Container;s_oStage.addChild(e);var f=s_oSpriteLibrary.getSprite("control_panel"),h=createBitmap(f);h.regX=f.width/2;h.regY=f.height/2;e.addChild(h);e.x=CANVAS_WIDTH/2;e.y=CANVAS_HEIGHT+f.height/2;a=e.y;(new createjs.Tween.get(e)).to({y:CANVAS_HEIGHT/
2},500,createjs.Ease.quartIn);var k=800,l=120,m=-f.height/2+100;new CTLText(e,-(k/2),m-l/2,k,l,120,"center","#1ef400",SECONDARY_FONT,1,2,2,TEXT_HELP,!0,!0,!1,!1);var n=200;l=40;m=-150;f=new CTLText(e,-550,m-l/2,n,l,40,"left","#1ef400",SECONDARY_FONT,1,2,2,TEXT_CLASSIC,!0,!0,!1,!1);k=900;l=40;n=f.getX()+n+10;new CTLText(e,n,m-l/2,k,l,30,"left","#ffffff",PRIMARY_FONT,1,2,2,TEXT_HELP_CLASSIC,!0,!0,!0,!1);n=200;l=40;m=-50;h=new CTLText(e,-550,m-l/2,n,l,40,"left","#1ef400",SECONDARY_FONT,1,2,2,TEXT_ADVANCED,
!0,!0,!1,!1);k=900;l=40;n=f.getX()+n+10;k=new CTLText(e,n,m-l/2,k,l,20,"left","#ffffff",PRIMARY_FONT,1,2,2,TEXT_HELP_ADVANCED,!0,!0,!0,!1);f=s_oSpriteLibrary.getSprite("but_air_strike");d=new CToggle(k.getX()+f.width/4,h.getY()+190,f,!0,e);d.setClickable(!1);k=600;l=f.height;n=d.getPos().x+100;m=d.getPos().y;new CTLText(e,n,m-l/2,k,l,34,"left","#ffffff",PRIMARY_FONT,1.2,2,2,TEXT_HELP_AIRSTRIKE,!0,!0,!0,!1);c=new CAnimatedButton(d.getPos().x,d.getPos().y+150,s_oRadarSpritesheet,e);c.enable(!0);c.setClickable(!1);
k=600;l=f.height;n=c.getPos().x+100;m=c.getPos().y;new CTLText(e,n,m-l/2,k,l,34,"left","#ffffff",PRIMARY_FONT,1.2,2,2,TEXT_HELP_RADAR,!0,!0,!0,!1)};this.unload=function(){(new createjs.Tween.get(b)).to({alpha:0},500);(new createjs.Tween.get(e)).to({y:a},400,createjs.Ease.backIn).call(function(){s_oStage.removeChild(b);s_oStage.removeChild(e);d.unload();c.unload()});b.off("mousedown",g)};this._init()}
function CCreditsPanel(){var a,g,b,e,d,c,f;this._init=function(){g=new createjs.Shape;g.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.alpha=0;s_oStage.addChild(g);(new createjs.Tween.get(g)).to({alpha:.7},500);c=new createjs.Shape;c.graphics.beginFill("#0f0f0f").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);c.alpha=.01;f=c.on("click",this._onLogoButRelease);s_oStage.addChild(c);b=new createjs.Container;s_oStage.addChild(b);var h=s_oSpriteLibrary.getSprite("msg_box"),k=createBitmap(h);
k.regX=h.width/2;k.regY=h.height/2;b.addChild(k);b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT+h.height/2;a=b.y;(new createjs.Tween.get(b)).to({y:CANVAS_HEIGHT/2-40},500,createjs.Ease.quartIn);k=300;var l=30;new CTLText(b,-(k/2),-h.height/2+100-l/2,k,l,30,"center","#1ef400",SECONDARY_FONT,1,2,2,TEXT_DEVELOPED,!0,!0,!1,!1);k=300;l=30;new CTLText(b,-(k/2),80-l/2,k,l,30,"center","#1ef400",SECONDARY_FONT,1,2,2,"",!0,!0,!1,!1);h=s_oSpriteLibrary.getSprite("ctl_logo");d=createBitmap(h);d.regX=
h.width/2;d.regY=h.height/2;b.addChild(d);h=s_oSpriteLibrary.getSprite("but_exit");e=new CGfxButton(210,-122,h,b);e.addEventListener(ON_MOUSE_UP,this.unload,this)};this.unload=function(){s_oStage.removeChild(c);e.setClickable(!1);(new createjs.Tween.get(g)).to({alpha:0},500);(new createjs.Tween.get(b)).to({y:a},400,createjs.Ease.backIn).call(function(){s_oStage.removeChild(g);s_oStage.removeChild(b);e.unload()});c.off("click",f)};this._onLogoButRelease=function(){};
this._onMoreGamesReleased=function(){window.open("http://codecanyon.net/collections/5409142-games")};this._init()}
function CAreYouSurePanel(a){var g,b,e,d,c,f;this._init=function(k){s_oGame.pauseGame(!0);d=new createjs.Shape;d.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.alpha=0;f=d.on("mousedown",function(){});s_oStage.addChild(d);(new createjs.Tween.get(d)).to({alpha:.7},500);c=new createjs.Container;s_oStage.addChild(c);k=s_oSpriteLibrary.getSprite("msg_box");var l=createBitmap(k);l.regX=k.width/2;l.regY=k.height/2;c.addChild(l);c.x=CANVAS_WIDTH/2;c.y=CANVAS_HEIGHT+k.height/2;g=c.y;
(new createjs.Tween.get(c)).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.quartIn);new CTLText(c,-200,-k.height/2+110-50,400,100,50,"center","#1ef400",SECONDARY_FONT,1,2,2,TEXT_ARE_SURE,!0,!0,!0,!1);b=new CGfxButton(110,80,s_oSpriteLibrary.getSprite("but_yes"),c);b.addEventListener(ON_MOUSE_UP,this._onButYes,this);e=new CGfxButton(-110,80,s_oSpriteLibrary.getSprite("but_not"),c);e.addEventListener(ON_MOUSE_UP,this._onButNo,this);e.pulseAnimation()};this._onButYes=function(){e.setClickable(!1);b.setClickable(!1);
s_oGame.pauseGame(!1);(new createjs.Tween.get(d)).to({alpha:0},500);(new createjs.Tween.get(c)).to({y:g},400,createjs.Ease.backIn).call(function(){h.unload();a()})};this._onButNo=function(){e.setClickable(!1);b.setClickable(!1);s_oGame.pauseGame(!1);(new createjs.Tween.get(d)).to({alpha:0},500);(new createjs.Tween.get(c)).to({y:g},400,createjs.Ease.backIn).call(function(){h.unload()})};this.unload=function(){e.unload();b.unload();s_oStage.removeChild(d);s_oStage.removeChild(c);d.off("mousedown",f)};
var h=this;this._init(a)}
function CEndPanel(a){var g,b,e,d,c,f,h;this._init=function(l){g=null;setVolume("soundtrack",1);e=new createjs.Container;e.alpha=0;e.visible=!1;s_oStage.addChild(e);d=new createjs.Shape;d.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);d.alpha=.7;e.addChild(d);l=s_oSpriteLibrary.getSprite("msg_box");b=createBitmap(l);b.regX=l.width/2;b.regY=l.height/2;b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT/2;e.addChild(b);l=500;var m=100,n=CANVAS_WIDTH/2,p=CANVAS_HEIGHT/2-50;c=new CTLText(e,n-l/
2,p-m/2,l,m,100,"center","#1ef400",SECONDARY_FONT,1,2,2," ",!0,!0,!1,!1);l=500;m=40;n=CANVAS_WIDTH/2;p=CANVAS_HEIGHT/2+50;f=new CTLText(e,n-l/2,p-m/2,l,m,40,"center","#1ef400",SECONDARY_FONT,1,2,2," ",!0,!0,!1,!1)};this.unload=function(){null!==g&&clearTimeout(g);e.off("mousedown",h)};this._initListener=function(){h=e.on("mousedown",this._onExit)};this.show=function(l){playSound("game_over",1,!1);a===PLAYER?(c.refreshText(TEXT_WIN),this._winnerAnim()):(c.refreshText(TEXT_LOSE),this._loseAnim());f.refreshText(sprintf(TEXT_SCORE,
l));e.visible=!0;var m=this;createjs.Tween.get(e).to({alpha:1},500).call(function(){m._initListener()});$(s_oMain).trigger("save_score",l,s_iMode);$(s_oMain).trigger("end_level",1);$(s_oMain).trigger("share_event",l)};this._winnerAnim=function(){g=setTimeout(function(){(new CAirStrike(e)).endAnim({x:CANVAS_WIDTH+(200+200*Math.random()),y:CANVAS_HEIGHT+(-400-200*Math.random())},{x:-250-250*Math.random(),y:-300-300*Math.random()},2E3+2E3*Math.random());k._winnerAnim()},1E3+1E3*Math.random())};this._loseAnim=
function(){g=setTimeout(function(){var l=new createSprite(s_oMissileExplosionSpritesheet,"idle",0,0,0,0);l.on("animationend",this._endExplosion,this,!1,{missile:l});playSound("missile_explosion",1,!1);l.x=CANVAS_WIDTH*Math.random();l.y=CANVAS_HEIGHT*Math.random();e.addChild(l);k._loseAnim()},400+400*Math.random())};this._endExplosion=function(l,m){l.remove();e.removeChild(m.missile)};this._onExit=function(){$(s_oMain).trigger("show_interlevel_ad");e.off("mousedown",h);s_oStage.removeChild(e);s_oGame.onExit()};
this._init(a);var k=this;return this}
function CSandBoxBoard(a,g,b,e){var d,c,f;this._init=function(h,k,l,m){c=[];f=null;this._initBoard();new CBoardUtility(d)};this.unload=function(){b.removeChild();for(var h=0;h<NUM_CELL;h++)for(var k=0;k<NUM_CELL;k++)d[h][k].unload()};this.getSandBoxMode=function(){return e};this._initBoard=function(){var h=NUM_CELL,k=CELL_LENGTH,l=-BOARD_LENGTH/2+k/2;d=[];for(var m=0;m<h;m++){d[m]=[];for(var n=0;n<h;n++)d[m][n]=new CSandBoxCell(l+n*k+-2,l+m*k+54,m,n,b),d[m][n].setVisible(e)}};this.snapFromRelease=
function(h){this.snapShip(f,h)};this.snapShip=function(h,k){var l=k.getShipContainer();if(null!==h){var m=this._checkFreeCells(h.row,h.col,k);if(m.free){var n=d[h.row][h.col];n=b.localToGlobal(n.getPos().x,n.getPos().y);l.x=n.x/s_iScaleFactor;l.y=n.y/s_iScaleFactor;this.setDeniedArea(m.list);k.setListCellOccupied(m.list);c.push(k);this.hideHighlight();this.printDebug()}else this.resetShip(k)}else this.resetShip(k);e&&s_oSandBoxMenu.checkPlayable()};this._checkFreeCells=function(h,k,l){l=l.getMap();
for(var m=[],n=!0,p=0;p<l.length;p++)for(var q=0;q<l[p].length;q++){var r=h+p,t=k+q;if(r>=NUM_CELL||t>=NUM_CELL||d[r][t].isShipOn())return n=!1,{free:n,list:[]};m.push({row:r,col:t})}return{free:n,list:m}};this.setShipOnCell=function(h,k){for(var l=0;l<h.length;l++)d[h[l].row][h[l].col].setShip(k)};this.resetShip=function(h){this.hideHighlight();var k=h.getListCellOccupied();this.setShipOnCell(k,!1);h.returnInStartPos()};this._findShipPos=function(h){h=h.getShipContainer();h=s_oStage.localToLocal(h.x,
h.y,b);for(var k=null,l=0;l<NUM_CELL;l++)for(var m=0;m<NUM_CELL;m++){var n=d[l][m],p=h.x-n.getPos().x,q=h.y-n.getPos().y;n.hitTest(p,q)&&(k={row:l,col:m})}return k};this._findAllPiecesPos=function(h,k,l){var m=[];m.push({row:h,col:k});for(var n=0;n<l.length;n++)for(var p=0;p<l[n].length;p++){var q=h+n,r=k+p;q<NUM_CELL&&r<NUM_CELL&&m.push({row:q,col:r})}return m};this.setDeniedArea=function(h){for(var k=[],l=0;l<h.length;l++){d[h[l].row][h[l].col].highlightDeniedArea(!0);k.push({row:h[l].row,col:h[l].col});
for(var m=s_oBoardUtility.getAllNeighbor(h[l].row,h[l].col),n=0;n<m.length;n++){var p=m[n].row,q=m[n].col;d[p][q].highlightDeniedArea(!0);k.push({row:p,col:q})}}this.setShipOnCell(k,!0)};this.highlightSnap=function(h){this.hideHighlight();var k=this._findShipPos(h);if(null!==k){h=this._findAllPiecesPos(k.row,k.col,h.getMap());for(var l=0;l<h.length;l++)d[h[l].row][h[l].col].highlight(!0)}f=k};this.hideHighlight=function(){for(var h=0;h<NUM_CELL;h++)for(var k=0;k<NUM_CELL;k++)d[h][k].highlight(!1)};
this.removeAllDenied=function(){for(var h=0;h<NUM_CELL;h++)for(var k=0;k<NUM_CELL;k++)d[h][k].highlightDeniedArea(!1),d[h][k].setShip(!1)};this.refreshDenied=function(){this.removeAllDenied();for(var h=0;h<c.length;h++)this.setDeniedArea(c[h].getListCellOccupied())};this.removeShip=function(h){for(var k=0;k<c.length;k++)c[k]===h&&(c[k].setListCellOccupied([]),c.splice(k,1));this.refreshDenied();this.highlightSnap(h);this.printDebug()};this.shuffle=function(h){this.clearAll(h);for(var k=0;k<h.length;k++)for(var l=
h[k].getListCellOccupied(),m=100;0===l.length;){l=Math.floor(Math.random()*NUM_CELL);var n=Math.floor(Math.random()*NUM_CELL);.5>Math.random()&&h[k].rotateMap();this.snapShip({row:l,col:n},h[k]);l=h[k].getListCellOccupied();m--;0===m&&this.shuffle(h)}};this.clearAll=function(h){for(var k=0;k<h.length;k++)h[k].isHorizontal()&&h[k].rotateMap(),this.removeShip(h[k]),this.resetShip(h[k])};this.printDebug=function(){for(var h=[],k=0;k<d.length;k++){h[k]=[];for(var l=0;l<d[k].length;l++)void 0!==d[k][l]&&
(d[k][l].isShipOn()?h[k][l]=1:h[k][l]=0)}this.printMat(h)};this.printMat=function(h){for(var k=0;k<h.length;k++)for(var l=0;l<h[k].length;l++);};this._init(a,g,b,e)}
function CSandBoxCell(a,g,b,e,d){var c,f,h,k,l,m;this._init=function(n,p,q,r,t){c=!1;f=new createjs.Container;f.x=n;f.y=p;t.addChild(f);h=null;n=s_oSpriteLibrary.getSprite("highlight");m=createBitmap(n);m.regX=n.width/2;m.regY=n.height/2;m.alpha=.8;m.visible=!1;f.addChild(m);n=s_oSpriteLibrary.getSprite("occupied_area");l=createBitmap(n);l.regX=n.width/2;l.regY=n.height/2;l.visible=!1;f.addChild(l);k=new createjs.Shape;k.graphics.beginFill("rgba(158,0,0,0.01)").drawRect(-CELL_LENGTH/2,-CELL_LENGTH/
2,CELL_LENGTH,CELL_LENGTH);f.addChild(k)};this.unload=function(){d.removeChild(f)};this.setClickableArea=function(n){k.visible=n};this.highlightDeniedArea=function(n){l.visible=n};this.highlight=function(n){m.visible=n};this.isHighlight=function(){return m.visible};this._onCellClick=function(){};this.setActive=function(n){null!==h&&h.setActive(n)};this.setVisible=function(n){f.visible=n};this.setShip=function(n){c=n};this.isShipOn=function(){return c};this.getPos=function(){return{x:a,y:g}};this.getLogicPos=
function(){return{row:b,col:e}};this.hitTest=function(n,p){return f.hitTest(n,p)};this._init(a,g,b,e,d)}
function CSandBoxMenu(a){var g,b,e,d,c,f,h,k,l,m,n,p,q,r,t;this._init=function(){p=null;var u=createBitmap(s_oSpriteLibrary.getSprite("bg_sandbox_menu"));s_oStage.addChild(u);f=new createjs.Container;f.x=CANVAS_WIDTH/2;f.y=CANVAS_HEIGHT/2;s_oStage.addChild(f);new CTLText(s_oStage,CANVAS_WIDTH/2-350,131,700,70,70,"center","#1ef400",SECONDARY_FONT,1,2,2,TEXT_STRATEGY_PANEL,!0,!0,!1,!1);u=s_oSpriteLibrary.getSprite("but_shuffle");h=new CGfxButton(1450,220,u,s_oStage);h.addEventListener(ON_MOUSE_UP,this._onAuto,
this);u=s_oSpriteLibrary.getSprite("but_delete");k=new CGfxButton(1450,425,u,s_oStage);k.addEventListener(ON_MOUSE_UP,this._onButClear,this);u=s_oSpriteLibrary.getSprite("but_rotate");m=new CGfxButton(1450,630,u,s_oStage);m.setVisible(!1);m.addEventListener(ON_MOUSE_UP,this._onButRotate,this);u=s_oSpriteLibrary.getSprite("but_play");l=new CGfxButton(1472,CANVAS_HEIGHT-226,u,s_oStage);l.addEventListener(ON_MOUSE_UP,this._onButPlayRelease,this);l.setVisible(!1);u=s_oSpriteLibrary.getSprite("but_exit");
e=CANVAS_WIDTH-u.height/2-10;d=u.height/2+10;r=new CGfxButton(e,d,u,s_oStage);r.addEventListener(ON_MOUSE_UP,this._onExit,this);g=CANVAS_WIDTH-u.width/2-110;b=u.height/2+10;if(!1===DISABLE_SOUND_MOBILE||!1===s_bMobile)u=s_oSpriteLibrary.getSprite("audio_icon"),t=new CToggle(g,b,u,s_bAudioActive,s_oStage),t.addEventListener(ON_MOUSE_UP,this._onAudioToggle,this);n=new CSandBoxBoard(0,0,f,!0);u=new createjs.Container;s_oStage.addChild(u);c=[];c[0]=new CShip(300,200,SHIP_SMALL,u,n);c[1]=new CShip(400,
156,SHIP_SUB,u,n);c[2]=new CShip(300,440,SHIP_MEDIUM,u,n);c[3]=new CShip(400,390,SHIP_LONG,u,n);c[4]=new CShip(300,700,SHIP_BATTLE,u,n);c[5]=new CShip(400,750,SHIP_CARRIER,u,n);q=new createjs.Shape;q.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);s_oStage.addChild(q);createjs.Tween.get(q).to({alpha:0},1E3).call(function(){q.visible=!1});this.refreshButtonPos(s_iOffsetX,s_iOffsetY)};this.refreshButtonPos=function(u,F){r.setPosition(e-u,F+d);!1!==DISABLE_SOUND_MOBILE&&!1!==s_bMobile||
t.setPosition(g-u,F+b)};this.unload=function(){s_oSandBoxMenu=null;h.unload();k.unload();l.unload();s_oStage.removeAllChildren();n.unload();for(var u=0;u<c.length;u++)c[u].unload()};this.setActiveShip=function(u){p=u;null===p?m.setVisible(!1):m.setVisible(!0)};this.getShipList=function(){return c};this._onAuto=function(){n.shuffle(c)};this._onButClear=function(){n.clearAll(c);this.checkPlayable()};this._onButRotate=function(){null!==p&&p._onShipRotate()};this.onExit=function(){$(s_oMain).trigger("end_session");
s_oMain.gotoMenu()};this.checkPlayable=function(){for(var u=!0,F,w=0;w<c.length;w++)F=c[w].getListCellOccupied(),0===F.length&&(u=!1);u?l.setVisible(!0):l.setVisible(!1)};this._onButPlayRelease=function(){this.unload();s_oMain.gotoGame(c)};this._onExit=function(){this.unload();s_oMain.gotoMenu()};this._onAudioToggle=function(){Howler.mute(s_bAudioActive);s_bAudioActive=!s_bAudioActive};s_oSandBoxMenu=this;this._init()}var s_oSandBoxMenu=null;
function CShip(a,g,b,e,d){var c,f,h,k,l,m,n,p,q,r,t,u,F,w,y,A,x,B,I;this._init=function(H,C,G,M,O){l=O.getSandBoxMode();m=!1;n=-4;p=40;h=H;k=C;q=G.map;r=[];t=[];u=new createjs.Container;u.x=H;u.y=C;l&&(A=u.on("mousedown",this._onShipClick),x=u.on("pressmove",this._onShipMove),I=u.on("dblclick",this._onShipRotate),B=u.on("pressup",this._onShipRelease),M.addChild(u));this.drawMap();this.drawShip()};this.drawMap=function(){for(var H=0;H<t.length;H++)for(var C=0;C<t[H].length;C++)u.removeChild(t[H][C]);
var G=0,M=0;t=[];for(H=0;H<q.length;H++){t[H]=[];for(C=0;C<q[H].length;C++)if(q[H][C]){var O=new createjs.Shape;O.graphics.beginFill("rgba(158,158,158,0.01)").drawRect(-CELL_LENGTH/2,-CELL_LENGTH/2,CELL_LENGTH,CELL_LENGTH);O.x=G;O.y=M;u.addChild(O);G+=CELL_LENGTH;t[H][C]=O}G=0;M+=CELL_LENGTH}};this.drawShip=function(){F=s_oSpriteLibrary.getSprite(b.sandbox_sprite);w=createBitmap(F);w.regX=F.width/2+n;w.regY=p;b===SHIP_CARRIER&&(w.regX=F.width/4);u.addChild(w);if(l){var H=s_oSpriteLibrary.getSprite("shape_"+
b.battle_spritesheet);y=createBitmap(H);y.x=a;y.y=g;y.regX=F.width/2+n-8;y.regY=p-10;b===SHIP_CARRIER&&(y.regX=F.width/4-8);e.addChild(y)}};this.unload=function(){l&&(u.off("mousedown",A),u.off("pressmove",x),u.off("dblclick",I),u.off("pressup",B),e.removeChild(u))};this._onShipClick=function(H){d.removeShip(z);l&&s_oSandBoxMenu.setActiveShip(z);c=H.localX;f=H.localY};this._onShipMove=function(H){u.x-=c-H.localX;u.y-=f-H.localY;c=H.localX;f=H.localY;d.highlightSnap(z)};this._onShipRelease=function(){d.snapFromRelease(z)};
this._onShipRotate=function(){z.rotateMap();d.removeShip(z);d.snapFromRelease(z)};this.rotateMap=function(){(m=!m)?(w.rotation=-90,w.scaleY=-1,w.regY=F.height-p,b===SHIP_CARRIER&&(w.regX=3*F.width/4-2)):(w.rotation=0,w.scaleY=1,w.regY=p,b===SHIP_CARRIER&&(w.regX=F.width/4));q=q[0].map(function(H,C){return q.map(function(G){return G[C]})});z.drawMap();r=[]};this.getShipContainer=function(){return u};this.getMap=function(){return q};this.returnInStartPos=function(){u.x=h;u.y=k;r=[];m&&this._onShipRotate();
l&&s_oSandBoxMenu.setActiveShip(null)};this.setListCellOccupied=function(H){r=[];for(var C=0;C<H.length;C++)r.push(H[C])};this.getListCellOccupied=function(){return r};this.getPos=function(){return{x:u.x,y:u.y}};this.getType=function(){return b};this.isHorizontal=function(){return m};this.hitShip=function(H,C){for(var G=0;G<r.length;G++)r[G].row===H&&r[G].col===C&&(r[G].hit=!0)};this.isPartiallyDamaged=function(){for(var H=!1,C=0;C<r.length;C++)r[C].hit&&(H=!0);return H};this.isSunk=function(){for(var H=
!0,C=0;C<r.length;C++)r[C].hit||(H=!1);return H};this.debugShips=function(){e.addChild(u)};this._init(a,g,b,e,d);var z=this}
function CRuler(a){var g,b,e,d,c,f,h;this._init=function(k){g=new createjs.Container;g.x=-CANVAS_WIDTH/2;g.y=-CANVAS_HEIGHT/2;k.addChild(g);b=new createjs.Shape;b.graphics.beginFill("rgba(255,255,255,0.6)").drawRect(0,-1.5,CANVAS_WIDTH,3);g.addChild(b);e=new createjs.Shape;e.graphics.beginFill("rgba(255,255,255,0.6)").drawRect(-1.5,0,3,CANVAS_HEIGHT);g.addChild(e);d=new createjs.Shape;d.graphics.beginFill("rgba(255,255,255,0.01)").drawRect(356,118,1208,844);g.addChild(d);b.mask=d;e.mask=d;c=new createjs.Container;
c.mask=d;g.addChild(c);h=new createjs.Text("0"," 34px "+SECONDARY_FONT,"#000000");h.x=54;h.y=-46;h.textAlign="left";h.textBaseline="middle";c.addChild(h);f=new createjs.Text("0"," 34px "+SECONDARY_FONT,"#ffffff");f.x=50;f.y=-50;f.textAlign="left";f.textBaseline="middle";c.addChild(f)};this.updatePos=function(k,l){e.x=k/s_iScaleFactor;b.y=l/s_iScaleFactor;c.x=k/s_iScaleFactor;c.y=l/s_iScaleFactor;var m=parseInt(k),n=parseInt(l);f.text="("+m+","+n+")";h.text="("+m+","+n+")"};this.show=function(k){g.visible=
k};this._init(a)}
function CAI(a){var g,b,e,d,c,f,h,k,l;this._init=function(m){g=AI_STATE_NEW_COORDINATE;b=AI_FIND_DIRECTION;e=[];d=[DIR_RIGHT,DIR_BOT,DIR_LEFT,DIR_TOP];f=[];h=[];l=null};this.getCoordinate=function(m){switch(g){case AI_STATE_NEW_COORDINATE:return this._getRandomCoordinate(m);case AI_STATE_FIND_SHIP_NEIGHBOR:return this._getLastDirectionCoordinate()}};this._getRandomCoordinate=function(m){e=[];for(m=0;m<NUM_CELL;m++)for(var n=0;n<NUM_CELL;n++)a.getCellState(m,n)===CELL_STATE_VOID&&e.push({row:m,col:n});
m=e[Math.floor(Math.random()*e.length)];this._predictHit(m.row,m.col)===PREDICT_HIT&&(b=AI_FIND_DIRECTION,g=AI_STATE_FIND_SHIP_NEIGHBOR,c=[],c.push(m),this._setViableDirection(c[0]));return m};this._getLastDirectionCoordinate=function(){switch(b){case AI_FIND_DIRECTION:l=d[Math.floor(Math.random()*d.length)];var m=s_oBoardUtility.getNeighborByDir(c[0].row,c[0].col,l);var n=this._predictHit(m.row,m.col);n===PREDICT_HIT?(b=AI_FOLLOW_DIRECTION,c.push(m)):this._removeDirection();break;case AI_FOLLOW_DIRECTION:m=
c[c.length-1];m=s_oBoardUtility.getNeighborByDir(m.row,m.col,l);if(null===m||a.getCellState(m.row,m.col)===CELL_STATE_WATER)return b=AI_REVERSE_DIRECTION,this._getLastDirectionCoordinate();c.push(m);n=this._predictHit(m.row,m.col);n===PREDICT_WATER&&(b=AI_REVERSE_DIRECTION);break;case AI_REVERSE_DIRECTION:m=l;this._removeDirection();l=s_oBoardUtility.getReverseDirection(m);m=s_oBoardUtility.getNeighborByDir(c[0].row,c[0].col,l);if(null===m||a.getCellState(m.row,m.col)===CELL_STATE_WATER)return this._setCarrierFound(),
this._getLastDirectionCoordinate();n=this._predictHit(m.row,m.col);n===PREDICT_WATER?this._setCarrierFound():b=AI_FOLLOW_REVERSE;c.push(m);break;case AI_FOLLOW_REVERSE:m=c[c.length-1];m=s_oBoardUtility.getNeighborByDir(m.row,m.col,l);if(null===m||a.getCellState(m.row,m.col)===CELL_STATE_WATER)return this._setCarrierFound(),this._getLastDirectionCoordinate();c.push(m);n=this._predictHit(m.row,m.col);n===PREDICT_WATER&&this._setCarrierFound();break;case AI_FOLLOW_CARRIER:m=this._findCarrierCell()}return m};
this._findCarrierCell=function(){if(0<f.length){var m=f[0];f.splice(0,1);0===f.length&&(f=s_oBoardUtility.getNeighborByShift(k,h[0]),k=s_oBoardUtility.getNeighborByShift(k,h[0]),null===f[0]||a.getCellState(f[0].row,f[0].col)===CELL_STATE_WATER)&&(0<h.length?(h.splice(0,1),f=s_oBoardUtility.getNeighborByShift(c,h[0]),k=s_oBoardUtility.getNeighborByShift(c,h[0])):(g=AI_STATE_NEW_COORDINATE,l=null,c=[]));var n=this._predictHit(m.row,m.col);n===PREDICT_WATER&&0<h.length&&(c.push(m),f=[],h.splice(0,1))}else{this._removeWaterCell();
f=s_oBoardUtility.getNeighborByShift(c,h[0]);k=s_oBoardUtility.getNeighborByShift(c,h[0]);if(null===f[0]||a.getCellState(f[0].row,f[0].col)===CELL_STATE_WATER)h.splice(0,1),f=s_oBoardUtility.getNeighborByShift(c,h[0]),k=s_oBoardUtility.getNeighborByShift(c,h[0]);m=f[0];f.splice(0,1);n=this._predictHit(m.row,m.col);n===PREDICT_WATER&&(c.push(m),f=[],h.splice(0,1))}return m};this._predictHit=function(m,n){var p=a.isShipOn(m,n);if(null!==p){p=p.getListCellOccupied();for(var q=[],r=0;r<p.length;r++)p[r].row===
m&&p[r].col===n||q.push(p[r]);p=this._checkSunk(q)?PREDICT_SUNK:PREDICT_HIT}else p=PREDICT_WATER;return p};this._checkSunk=function(m){for(var n=!0,p=0;p<m.length;p++)m[p].hit||(n=!1);return n};this._setCarrierFound=function(){b=AI_FOLLOW_CARRIER;h=c[0].row===c[1].row?[DIR_TOP,DIR_BOT]:[DIR_LEFT,DIR_RIGHT];shuffle(h)};this.resetToStartState=function(){b=AI_FIND_DIRECTION;g=AI_STATE_NEW_COORDINATE;l=null;c=[]};this._setViableDirection=function(m){d=[];d=s_oBoardUtility.getCrossDir(m.row,m.col);for(var n=
d.length-1;0<=n;n--){var p=s_oBoardUtility.getNeighborByDir(m.row,m.col,d[n]);a.getCellState(p.row,p.col)===CELL_STATE_WATER&&d.splice(n,1)}};this._removeDirection=function(){var m=d.indexOf(l);d.splice(m,1);l=null};this._removeWaterCell=function(){for(var m=c.length-1;0<=m;m--)a.getCellState(c[m].row,c[m].col)===CELL_STATE_WATER&&c.splice(m,1)};this._init(a)}
function CTurnWaiter(a){var g,b,e,d,c,f;this._init=function(k){g=new createjs.Container;g.x=0;g.y=0;var l=CANVAS_WIDTH,m=CANVAS_HEIGHT;l=(new createjs.Graphics).beginFill("rgba(0,0,0,0.2)").drawRect(0,0,l,m);e=new createjs.Shape(l);f=e.on("click",function(){});b=new createjs.Text("","60px "+PRIMARY_FONT,"#ffffff");b.x=0;b.y=-55;b.textAlign="center";b.textBaseline="alphabetic";b.lineWidth=800;d=new createjs.Text("","180px "+PRIMARY_FONT,"#ffffff");d.x=-85;d.y=10;d.textAlign="left";d.textBaseline="alphabetic";
d.lineWidth=800;c=new createSprite(s_oWaitPlayerSpritesheet,"idle",0,0,0,0);c.x=CANVAS_WIDTH/2-270;c.y=CANVAS_HEIGHT/2-200;g.addChild(e,b,d,c);k.addChild(g);h.hide()};this.show=function(k){null==k&&(k="");b.text=k;g.visible=!0};this.hide=function(){b.text="";g.visible=!1};this.unload=function(){e.off("click",f);a.removeChild(g)};this.update=function(){};var h=this;this._init(a)}
function CAirStrike(a){var g,b=CANVAS_WIDTH+200,e=CANVAS_HEIGHT-400;this._init=function(c){g=new createjs.Container;g.x=b;g.y=e;g.scaleX=g.scaleY=.6;c.addChild(g);c=s_oSpriteLibrary.getSprite("air");var f=createBitmap(c);f.regX=c.width/2;f.regY=c.height/2;g.addChild(f);c=s_oSpriteLibrary.getSprite("air_shadow");f=createBitmap(c);f.x=50;f.y=500;f.scaleX=f.scaleY=.75;f.regX=c.width/2;f.regY=c.height/2;g.addChild(f)};this.unload=function(){a.removeChild(g)};this.endAnim=function(c,f,h){playSound("air_strike",
1,!1);g.x=c.x;g.y=c.y;createjs.Tween.get(g).to({x:f.x,y:f.y},h).call(function(){d.unload()})};this.launch=function(){playSound("air_strike",1,!1);g.x=b;g.y=e;s_oGame.setNumMissileShot(NUM_BOMB_AIRSTRIKE);createjs.Tween.get(g).to({x:-250,y:-300},2E3,createjs.Ease.cubicIn);var c=this._getCellToHit();setTimeout(function(){for(var f=0;f<NUM_BOMB_AIRSTRIKE;f++)(new CMissile(a)).launchAirMissile({x:g.x,y:g.y},{row:c[f].row,col:c[f].col},.8+.4*Math.random())},1100)};this._getCellToHit=function(){for(var c=
s_oGame.getBoard(OPPONENT),f=[],h=0;h<NUM_CELL;h++)for(var k=0;k<NUM_CELL;k++)if(c.getCellState(h,k)===CELL_STATE_VOID){for(var l=s_oBoardUtility.getCrossNeighbor(h,k),m=!0,n=0;n<l.length;n++){var p=l[n];c.getCellState(p.row,p.col)===CELL_STATE_HIT&&(m=!1)}m&&f.push({row:h,col:k})}do for(c=[],h=0;h<NUM_BOMB_AIRSTRIKE;h++)c.push(f[Math.floor(Math.random()*f.length)]);while(this._checkNearCell(c));return c};this._checkNearCell=function(c){for(var f=0;f<c.length-1;f++){var h=c[f];h=s_oBoardUtility.getCrossNeighbor(h.row,
h.col);for(var k=0;k<h.length;k++)for(var l=f+1;l<c.length;l++)if(this._isEqual(c[f],c[l])||this._isEqual(h[k],c[l]))return!0}return!1};this._isEqual=function(c,f){return c.row===f.row&&c.col===f.col?!0:!1};var d=this;this._init(a)}var DIR_TOPRIGHT="DIR_TOPRIGHT",DIR_RIGHT="DIR_RIGHT",DIR_BOTRIGHT="DIR_BOTRIGHT",DIR_TOPLEFT="DIR_TOPLEFT",DIR_LEFT="DIR_LEFT",DIR_BOTLEFT="DIR_BOTLEFT",DIR_TOP="DIR_TOP",DIR_BOT="DIR_BOT";
function CBoardUtility(a){var g,b,e,d;this._init=function(c){g=c.length;b=c[0].length;d=[];e=[];for(c=0;c<g;c++){e[c]=[];for(var f=0;f<b;f++)e[c][f]=[]}this._buildMap()};this._buildMap=function(){for(var c=0;c<g;c++)for(var f=0;f<b;f++)e[c][f][DIR_TOPRIGHT]=this._setNeighbor(c,f,DIR_TOPRIGHT),e[c][f][DIR_RIGHT]=this._setNeighbor(c,f,DIR_RIGHT),e[c][f][DIR_BOTRIGHT]=this._setNeighbor(c,f,DIR_BOTRIGHT),e[c][f][DIR_TOPLEFT]=this._setNeighbor(c,f,DIR_TOPLEFT),e[c][f][DIR_LEFT]=this._setNeighbor(c,f,DIR_LEFT),
e[c][f][DIR_BOTLEFT]=this._setNeighbor(c,f,DIR_BOTLEFT),e[c][f][DIR_TOP]=this._setNeighbor(c,f,DIR_TOP),e[c][f][DIR_BOT]=this._setNeighbor(c,f,DIR_BOT)};this._setNeighbor=function(c,f,h){var k=null;switch(h){case DIR_TOPRIGHT:0<c&&f<b-1&&(k={row:c-1,col:f+1});break;case DIR_RIGHT:f<b-1&&(k={row:c,col:f+1});break;case DIR_BOTRIGHT:c<g-1&&f<b-1&&(k={row:c+1,col:f+1});break;case DIR_TOPLEFT:0<c&&0<f&&(k={row:c-1,col:f-1});break;case DIR_LEFT:0<f&&(k={row:c,col:f-1});break;case DIR_BOTLEFT:c<g-1&&0<f&&
(k={row:c+1,col:f-1});break;case DIR_TOP:0<c&&(k={row:c-1,col:f});break;case DIR_BOT:c<g-1&&(k={row:c+1,col:f})}return k};this.getNeighborByDir=function(c,f,h){return e[c][f][h]};this.getAllNeighbor=function(c,f){var h=[],k;for(k in e[c][f])null!==e[c][f][k]&&h.push(e[c][f][k]);return h};this.getCrossDir=function(c,f){for(var h=[],k=[DIR_TOP,DIR_RIGHT,DIR_BOT,DIR_LEFT],l=0;l<k.length;l++)null!==this.getNeighborByDir(c,f,k[l])&&h.push(k[l]);return h};this.getCrossNeighbor=function(c,f){for(var h=[],
k=[DIR_TOP,DIR_RIGHT,DIR_BOT,DIR_LEFT],l=0;l<k.length;l++){var m=this.getNeighborByDir(c,f,k[l]);null!==m&&h.push(m)}return h};this._getMainDiagonal=function(c,f,h){var k=[],l=h[c][f].getColor();this._findInDirection(c,f,DIR_BOTRIGHT,k,99,l,h);this._findInDirection(c,f,DIR_TOPLEFT,k,99,l,h);return k};this._getSecondDiagonal=function(c,f,h){var k=[],l=h[c][f].getColor();this._findInDirection(c,f,DIR_BOTLEFT,k,99,l,h);this._findInDirection(c,f,DIR_TOPRIGHT,k,99,l,h);return k};this._getRow=function(c,
f,h){var k=[],l=h[c][f].getColor();this._findInDirection(c,f,DIR_LEFT,k,99,l,h);this._findInDirection(c,f,DIR_RIGHT,k,99,l,h);return k};this._getCol=function(c,f,h){var k=[],l=h[c][f].getColor();this._findInDirection(c,f,DIR_TOP,k,99,l,h);this._findInDirection(c,f,DIR_BOT,k,99,l,h);return k};this._getStraightByDirAndRadius=function(c,f,h,k,l){var m=[];d=[];d.push({radius:k,direction:null});var n=l[c][f].getColor();this._findInDirection(c,f,h,m,k,n,l);return m};this._getStraightRowByRadius=function(c,
f,h){var k=[];d=[];d.push({radius:h,direction:null});this._findInDirection(c,f,DIR_LEFT,k,h);this._findInDirection(c,f,DIR_RIGHT,k,h);return k};this._getStraightColByRadius=function(c,f,h){var k=[];d=[];d.push({radius:h,direction:null});this._findInDirection(c,f,DIR_TOP,k,h);this._findInDirection(c,f,DIR_BOT,k,h);return k};this._findInDirection=function(c,f,h,k,l){--l;if(null!==e[c][f][h]&&0<=l){var m=e[c][f][h].row;c=e[c][f][h].col;k.push({row:m,col:c});d.push({radius:l,direction:h});this._findInDirection(m,
c,h,k,l)}};this.getNeighborByShift=function(c,f){for(var h=[],k=0;k<c.length;k++)h[k]=this.getNeighborByDir(c[k].row,c[k].col,f);return h};this.getReverseDirection=function(c){switch(c){case DIR_RIGHT:var f=DIR_LEFT;break;case DIR_BOT:f=DIR_TOP;break;case DIR_LEFT:f=DIR_RIGHT;break;case DIR_TOP:f=DIR_BOT}return f};this._init(a);s_oBoardUtility=this}var s_oBoardUtility;
function CBattleCell(a,g,b,e,d,c){var f,h,k,l,m,n,p;this._init=function(q,r,t,u,F,w){f=CELL_STATE_VOID;p=n=null;h=new createjs.Container;h.x=q;h.y=r;t.addChild(h);k=new createSprite(s_oBattleCellSpritesheet,"void",0,0,0,0);h.addChild(k);l=new createSprite(s_oMissileWaterSpritesheet,"stop",0,0,0,0);l.x=q+t.x;l.y=r+t.y;w.addChild(l);m=new createSprite(s_oMissileExplosionSpritesheet,"stop",0,0,0,0);m.x=q+t.x;m.y=r+t.y;w.addChild(m)};this.unload=function(){b.removeChild(h)};this.getPos=function(){return{x:a,
y:g}};this.debug=function(){var q=new createjs.Text(e+","+d," 14px Arial","#ffffff");q.textAlign="center";q.textBaseline="middle";q.lineWidth=200;h.addChild(q)};this.playWater=function(){l.gotoAndPlay("idle");playSound("missile_water",1,!1)};this.playExplosion=function(){m.gotoAndPlay("idle");playSound("missile_explosion",1,!1)};this.getState=function(){return f};this.setState=function(q){f=q;k.gotoAndStop(q);q===CELL_STATE_SUNK&&k.gotoAndStop(CELL_STATE_HIT)};this.setFinalExplosion=function(){playSound("missile_sink",
1,!1);p=new createSprite(s_oFinalExplosionSpritesheet,"idle",0,0,0,0);p.x=a+b.x;p.y=g+b.y;c.addChild(p)};this.setFire=function(){n=new createSprite(s_oFireSpritesheet,"idle",0,0,0,0);n.x=a+b.x;n.y=g+b.y;c.addChild(n)};this.removeFire=function(){null!==n&&n.gotoAndStop("stop")};this._init(a,g,b,e,d,c)}
function CAnimationSettings(){this._init=function(){this._initShips();this._initBattleCell();this._initMissile();this._initEnvironment();this._initGUI()};this._initShips=function(){s_aShipSpritesheet=[];for(var a=0;6>a;a++){var g=s_oSpriteLibrary.getSprite("ship"+a+"_3d");s_aShipSpritesheet[a]=new createjs.SpriteSheet({images:[g],frames:{width:g.width/6,height:g.height/5,regX:0,regY:0},animations:{idle:[0,29],stop:[30,30]}})}};this._initBattleCell=function(){var a=s_oSpriteLibrary.getSprite("cell_battle"),
g=a.width/3,b=a.height;a={images:[a],frames:{width:g,height:b,regX:g/2,regY:b/2},animations:{"void":[0],water:[1],hit:[2]}};s_oBattleCellSpritesheet=new createjs.SpriteSheet(a);a=s_oSpriteLibrary.getSprite("cell_control");g=a.width/5;b=a.height;a={images:[a],frames:{width:g,height:b,regX:g/2,regY:b/2},animations:{"void":[0],hit:[1],sunk:[2],water:[3],selection:[4]}};s_oControlCellSpritesheet=new createjs.SpriteSheet(a)};this._initMissile=function(){var a=s_oSpriteLibrary.getSprite("missile_reactor"),
g=a.width/2,b=a.height;a={images:[a],frames:{width:g,height:b,regX:g/2,regY:b/2},animations:{idle:[0,1]}};s_oMissileReactorSpritesheet=new createjs.SpriteSheet(a);a=s_oSpriteLibrary.getSprite("missile_smoke");g=a.width/5;b=a.height/10;a={images:[a],frames:{width:g,height:b,regX:g/2+20,regY:b/2},animations:{idle:[0,49,"stop"],stop:[50,50]}};s_oMissileSmokeSpritesheet=new createjs.SpriteSheet(a);a=s_oSpriteLibrary.getSprite("missile_water");g=a.width/7;b=a.height/4;a={images:[a],frames:{width:g,height:b,
regX:g/2,regY:b/2+40},animations:{idle:[0,27,"stop"],stop:[28,28]}};s_oMissileWaterSpritesheet=new createjs.SpriteSheet(a);a=s_oSpriteLibrary.getSprite("missile_explosion");g=a.width/6;b=a.height/5;a={framerate:15,images:[a],frames:{width:g,height:b,regX:g/2,regY:b/2},animations:{idle:[0,29,"stop"],stop:[30,30]}};s_oMissileExplosionSpritesheet=new createjs.SpriteSheet(a)};this._initEnvironment=function(){var a=s_oSpriteLibrary.getSprite("fire"),g=a.width/5,b=a.height/6;a={framerate:15,images:[a],
frames:{width:g,height:b,regX:g/2,regY:b-6},animations:{idle:[0,29],stop:[30,30]}};s_oFireSpritesheet=new createjs.SpriteSheet(a);a=s_oSpriteLibrary.getSprite("final_explosion");g=a.width/8;b=a.height/5;a={images:[a],frames:{width:g,height:b,regX:g/2,regY:b/2},animations:{idle:[0,39,"stop"],stop:[40,40]}};s_oFinalExplosionSpritesheet=new createjs.SpriteSheet(a);a=s_oSpriteLibrary.getSprite("wait_player");g=a.width/9;b=a.height/6;a={images:[a],frames:{width:g,height:b,regX:g/2,regY:b/2},animations:{idle:[0,
49],stop:[50,50]}};s_oWaitPlayerSpritesheet=new createjs.SpriteSheet(a)};this._initGUI=function(){var a=s_oSpriteLibrary.getSprite("but_radar"),g=a.width/15,b=a.height/4;s_oRadarSpritesheet=new createjs.SpriteSheet({images:[a],frames:{width:g,height:b,regX:g/2,regY:b/2},animations:{idle:[0,58],disable:[59,59]}})};this._init()}
var s_aShipSpritesheet,s_oBattleCellSpritesheet,s_oControlCellSpritesheet,s_oMissileReactorSpritesheet,s_oMissileSmokeSpritesheet,s_oMissileWaterSpritesheet,s_oMissileExplosionSpritesheet,s_oFireSpritesheet,s_oFinalExplosionSpritesheet,s_oWaitPlayerSpritesheet,s_oRadarSpritesheet;
function CPlayerBoard(a,g,b,e,d,c){var f,h,k,l;this._init=function(m,n,p,q,r,t){l=new createjs.Container;l.x=m;l.y=n;p.addChild(l);this._initBoard();r===PLAYER&&this._setShips()};this._initBoard=function(){h=[];var m=0,n=0;h=[];for(var p=0;p<NUM_CELL;p++){h[p]=[];for(var q=0;q<NUM_CELL;q++){var r=new CBattleCell(m,n,l,p,q,c);d===PLAYER?(m+=32,n-=18):(m-=32,n+=18);h[p][q]=r}d===PLAYER?(m=32*(p+1),n=18*(p+1)):(m=32*-(p+1),n=18*-(p+1))}};this._setShips=function(){k=[];for(var m=0;m<e.length;m++){var n=
e[m].getType(),p=e[m].getListCellOccupied(),q=p[0].row;p=p[0].col;var r=new createSprite(s_aShipSpritesheet[n.battle_spritesheet],"idle",0,0,0,0);r.x=h[q][p].getPos().x;r.y=h[q][p].getPos().y;r.regX=n.reg_points.x;r.regY=n.reg_points.y;d===OPPONENT&&(r.rotation=180);e[m].isHorizontal()&&(r.scaleX=-1,r.regX=n.reg_points.inverseX,r.regY=n.reg_points.inverseY);k.push(r);l.addChild(r)}};this.isShipOn=function(m,n){for(var p=0;p<e.length;p++)for(var q=e[p].getListCellOccupied(),r=0;r<q.length;r++)if(q[r].row===
m&&q[r].col===n)return e[p];return null};this.sunkAnimation=function(m){this.hideShip(m.getType().index_type);m=m.getListCellOccupied();for(var n=[],p=0;p<m.length;p++)n.push(m[p]);shuffle(n);var q=0;f=setInterval(function(){h[n[q].row][n[q].col].removeFire();h[n[q].row][n[q].col].setFinalExplosion();q++;q===n.length&&clearInterval(f)},200)};this.setFire=function(m,n){h[m][n].setFire()};this.setCellState=function(m,n,p){h[m][n].setState(p)};this.getCellState=function(m,n){return h[m][n].getState()};
this.getCells=function(){return h};this.getCellPos=function(m,n){var p=h[m][n].getPos();return{x:p.x+a,y:p.y+g}};this.getBounds=function(){return l.getBounds()};this.getPos=function(){return{x:a,y:g}};this.playExplosion=function(m,n){h[m][n].playExplosion()};this.playWater=function(m,n){h[m][n].playWater()};this.hideShip=function(m){d===PLAYER&&(k[m].visible=!1)};this._init(a,g,b,e,d,c)}
function CControlPanel(){var a,g,b,e,d,c=null,f,h,k,l,m;this._init=function(){g=new createjs.Shape;g.graphics.beginFill("black").drawRect(0,0,CANVAS_WIDTH,CANVAS_HEIGHT);g.alpha=0;m=g.on("mousedown",function(){});s_oStage.addChild(g);b=new createjs.Container;s_oStage.addChild(b);d=s_oSpriteLibrary.getSprite("control_panel");var p=createBitmap(d);p.regX=d.width/2;p.regY=d.height/2;b.addChild(p);b.x=CANVAS_WIDTH/2;b.y=CANVAS_HEIGHT+d.height/2;e=new createjs.Container;b.addChild(e);this._initControlCells();
this._setAlphabeticCoordinate();this._setNumCoordinate();p=s_oSpriteLibrary.getSprite("but_air_strike");var q=p.width/2,r=30;k=new CTLText(b,450-q/2,-352-r/2,q,r,30,"center","#1ef400",SECONDARY_FONT,1,2,2,sprintf(TEXT_COST,COST_AIRSTRIKE),!0,!0,!1,!1);f=new CToggle(450,-274,p,!1,b);f.addEventListener(ON_MOUSE_UP,this._onAirStrike,this);f.addEventListener(ON_MOUSE_OVER,this._hideRuler,this);f.addEventListener(ON_MOUSE_OUT,this._showRuler,this);f.enable(!1);s_iMode===MODE_CLASSIC&&(f.setVisible(!1),
k.setVisible(!1));q=p.width/2;r=30;l=new CTLText(b,450-q/2,-144-r/2,q,r,30,"center","#1ef400",SECONDARY_FONT,1,2,2,sprintf(TEXT_COST,COST_RADAR),!0,!0,!1,!1);h=new CAnimatedButton(450,-62,s_oRadarSpritesheet,b);h.addEventListener(ON_MOUSE_UP,this._onRadar,this);h.addEventListener(ON_MOUSE_OVER,this._hideRuler,this);h.addEventListener(ON_MOUSE_OUT,this._showRuler,this);h.enable(!1);s_iMode===MODE_CLASSIC&&(h.setVisible(!1),l.setVisible(!1));c=new CRuler(b)};this.unload=function(){s_oStage.removeChild(g);
s_oStage.removeChild(b);f.unload();h.unload();g.off("mousedown",m)};this._initControlCells=function(){var p=NUM_CELL,q=CONTROL_CELL_DIM,r=NUM_CELL/2*CONTROL_CELL_DIM-q/2;a=[];for(var t=0;t<p;t++){a[t]=[];for(var u=0;u<p;u++)a[t][u]=new CControlCell(r-u*q,r-t*q,e,t,u)}};this._setAlphabeticCoordinate=function(){for(var p=NUM_CELL-1;0<=p;p--){var q=new createjs.Text(String.fromCharCode(65+NUM_CELL-p-1)," 50px "+SECONDARY_FONT,"#60ff00");q.x=a[p][NUM_CELL-1].getPos().x-60;q.y=a[p][NUM_CELL-1].getPos().y;
q.textAlign="center";q.textBaseline="middle";e.addChild(q)}};this._setNumCoordinate=function(){for(var p=NUM_CELL-1;0<=p;p--){var q=new createjs.Text(NUM_CELL-p," 34px "+SECONDARY_FONT,"#60ff00");q.x=a[0][p].getPos().x;q.y=a[0][p].getPos().y+50;q.textAlign="center";q.textBaseline="middle";e.addChild(q)}};this.show=function(){b.visible=!0;createjs.Tween.get(g).to({alpha:.7},500);createjs.Tween.get(b).to({y:CANVAS_HEIGHT/2},500,createjs.Ease.quartIn)};this.hide=function(){createjs.Tween.removeTweens(g);
b.visible=!1;b.y=CANVAS_HEIGHT+d.height/2;g.alpha=0};this._showRuler=function(){c.show(!0)};this._hideRuler=function(){c.show(!1)};this.refresh=function(p){for(var q=0;q<a.length;q++)for(var r=0;r<a[q].length;r++){var t=p[q][r].getState();a[q][r].setState(t);a[q][r].disableHighlight()}p=s_oGame.getScore();p>COST_AIRSTRIKE&&f.enable(!0);p>COST_RADAR&&h.enable(!0)};this._onAirStrike=function(){this._showRuler();f.enable(!1);s_oGame.addScore(-COST_AIRSTRIKE);n.hide();s_oGame.launchAirStrike()};this._onRadar=
function(){playSound("sonar",1,!1);this._showRuler();h.enable(!1);s_oGame.addScore(-COST_RADAR);for(var p=s_oGame.getRandomAvailableShip(OPPONENT).getListCellOccupied(),q=[],r=0;r<p.length;r++)p[r].hit||q.push(p[r]);p=q[Math.floor(Math.random()*q.length)];a[p.row][p.col].highlight()};this.update=function(p){p&&c.updatePos(p.x,p.y)};var n=this;this._init()}
function CControlCell(a,g,b,e,d){var c,f,h,k,l,m,n;this._init=function(p,q,r,t,u){c=CELL_STATE_VOID;f=new createjs.Container;f.x=p;f.y=q;r.addChild(f);k=new createSprite(s_oControlCellSpritesheet,"void",0,0,0,0);f.addChild(k);h=new createSprite(s_oControlCellSpritesheet,"hit",0,0,0,0);h.alpha=0;f.addChild(h);p=new createjs.Shape;p.graphics.beginFill("rgba(158,0,0,0.01)").drawRect(-CONTROL_CELL_DIM/2,-CONTROL_CELL_DIM/2,CONTROL_CELL_DIM,CONTROL_CELL_DIM);f.addChild(p);l=f.on("mousedown",this._onCellClick,
this);m=f.on("mouseover",this._onCellOver,this);n=f.on("mouseout",this._onCellOut,this)};this.unload=function(){f.off("mousedown",l);f.off("mouseover",m);f.off("mouseout",n);b.removeChild(f)};this._onCellClick=function(){if(c===CELL_STATE_VOID)s_oGame.onCellClick(e,d)};this._onCellOver=function(){c===CELL_STATE_VOID&&k.gotoAndStop("selection")};this._onCellOut=function(){c===CELL_STATE_VOID&&k.gotoAndStop("void")};this.setState=function(p){c=p;k.gotoAndStop(p)};this.getState=function(){return c};
this.highlight=function(){createjs.Tween.get(h,{loop:!0}).to({alpha:1},500,createjs.Ease.cubicOut).to({alpha:0},500,createjs.Ease.cubicOut)};this.disableHighlight=function(){createjs.Tween.removeTweens(h);h.alpha=0};this.getPos=function(){return{x:f.x,y:f.y}};this._init(a,g,b,e,d)}
function CMissile(a,g){var b,e,d,c,f,h,k,l,m,n,p,q,r,t,u,F,w;this._init=function(y,A){b=!0;c=MISSILE_TYPE_NORMAL;f=0;h=50;k=new CVector2(0,0);m=new CVector2(0,-1);l=new CVector2(0,0);p=0;t=new createjs.Container;y.addChild(t);F=new createSprite(s_oMissileReactorSpritesheet,"idle",0,0,0,0);F.x=-1;F.y=28;F.visible=!1;t.addChild(F);var x=s_oSpriteLibrary.getSprite("missile");u=createBitmap(x);u.regX=x.width/2;u.regY=x.height/2;t.addChild(u);w=new createSprite(s_oMissileSmokeSpritesheet,"stop",0,0,0,
0);y.addChild(w)};this.reset=function(y,A,x){l.x=y;l.y=A;q=x;k=new CVector2(y,A);m=new CVector2(0,-1);l=new CVector2(y,A);p=0};this._findMiddlePoint=function(y,A,x){return x===PLAYER?y.y>A.y?y.x>A.x?new createjs.Point(y.x-.2*(y.x-A.x),A.y-200):new createjs.Point(A.x+.2*(A.x-y.x),A.y-200):y.x>A.x?new createjs.Point(y.x-.2*(y.x-A.x),y.y-200):new createjs.Point(A.x+.2*(A.x-y.x),y.y-200):y.y>A.y?y.x>A.x?new createjs.Point(y.x+.2*(y.x-A.x),A.y-200):new createjs.Point(A.x-.2*(A.x-y.x),A.y-200):y.x>A.x?
new createjs.Point(A.x+.2*(A.x-y.x),y.y-200):new createjs.Point(y.x-.2*(y.x-A.x),y.y-200)};this.launchMissileForPlayer=function(y,A){t.visible=!0;var x=this.getLaunchCoordinate(y,A,PLAYER),B=x.start;B.y-=17;var I=x.end,z=new createjs.Point(B.x,B.y);I=new createjs.Point(I.x,I.y);null!==x.ship&&4===x.ship.getType().battle_spritesheet?(c=MISSILE_TYPE_TORPEDO,x=s_oSpriteLibrary.getSprite("torpedo"),u.image=x,g.addChild(t),playSound("missile_torpedo",1,!1),b=!1,r=[new createjs.Point(z.x,z.y+17),I],t.rotation=
180/Math.PI*Math.atan2(I.y-z.y,I.x-z.x)+90,t.x=z.x,t.y=z.y+17):(c=MISSILE_TYPE_NORMAL,x=s_oSpriteLibrary.getSprite("missile"),u.image=x,a.addChild(t),playSound("missile_launch",1,!1),b=!1,x=this._findMiddlePoint(z,I,PLAYER),r=[z,x,I],w.gotoAndPlay("idle"),w.x=B.x,w.y=B.y,F.visible=!0,this.reset(z.x,z.y,1));return!0};this.launchMissileForOpponent=function(y,A){c=MISSILE_TYPE_NORMAL;var x=s_oSpriteLibrary.getSprite("missile");u.image=x;a.addChild(t);playSound("missile_launch",1,!1);b=!1;t.visible=!0;
var B=this.getLaunchCoordinate(y,A,OPPONENT);x=B.start;x.y-=17;var I=B.end;B=new createjs.Point(x.x,x.y);I=new createjs.Point(I.x,I.y);var z=this._findMiddlePoint(B,I,OPPONENT);r=[B,z,I];w.gotoAndPlay("idle");w.x=x.x;w.y=x.y;this.reset(B.x,B.y,1)};this.getLaunchCoordinate=function(y,A,x){e=y;d=A;var B=null;if(x===PLAYER){B=s_oGame.getRandomAvailableShip(PLAYER);x=B.getListCellOccupied();for(var I=[],z=0;z<x.length;z++)I.push(x[z]);for(z=I.length-1;0<=z;z--)I[z].hit&&I.splice(z,1);x=I[Math.floor(Math.random()*
I.length)];x=s_oGame.getCellPos(x.row,x.col,PLAYER);y=s_oGame.getCellPos(y,A,OPPONENT)}else x=s_oGame.getBoardPos(OPPONENT),y=s_oGame.getCellPos(y,A,PLAYER);return{start:x,end:y,ship:B}};this.setPos=function(y,A){k=new CVector2(l.x,l.y);l.x=y;l.y=A;n=new CVector2(y,A);n.subV(k);n.normalize();p=angleBetweenVector2D(m,n);p=k.getX()<y?radiansToDegree(p):-radiansToDegree(p)};this.launchAirMissile=function(y,A,x){var B=s_oGame.getCellPos(A.row,A.col,OPPONENT);t.x=y.x;t.y=y.y;t.alpha=0;t.rotation=-70;w.gotoAndPlay("idle");
w.x=y.x;w.y=y.y;createjs.Tween.get(t).to({alpha:1},300*x).call(function(){F.visible=!0;new CTremble(u,300,10,1);playSound("missile_launch",1,!1)});createjs.Tween.get(t).to({x:B.x},1400*x,createjs.Ease.quartIn);var I=50+50*Math.random();createjs.Tween.get(t).to({y:y.y+I},700*x,createjs.Ease.cubicOut).to({y:B.y},700*x,createjs.Ease.cubicIn).call(function(){s_oGame.onMissileArrived(A.row,A.col);t.visible=!1})};this.updateTorpedo=function(){if(!b){f++;f>h&&(f=0);var y=easeInQuart(f,0,1,h),A=new createjs.Point(r[0].x+
y*(r[1].x-r[0].x),r[0].y+y*(r[1].y-r[0].y));t.x=A.x;t.y=A.y;1===y&&(f=0,b=!0,t.visible=!1,s_oGame.onMissileArrived(e,d))}};this.updateMissile=function(){if(!b){f++;f>h&&(f=0);var y=easeInQuart(f,0,1,h),A=this.quad(y,r);this.setPos(A.x,A.y);this.updateGfx();1===y&&(f=0,b=!0,t.visible=!1,s_oGame.onMissileArrived(e,d))}};this.quad=function(y,A){var x=new createjs.Point,B=(1-y)*(1-y),I=y*y;x.x=B*A[0].x+2*(1-y)*y*A[1].x+I*A[2].x;x.y=B*A[0].y+2*(1-y)*y*A[1].y+I*A[2].y;return x};this.updateGfx=function(){t.x=
l.x;t.y=l.y;t.rotation=p*q};this.update=function(){switch(c){case MISSILE_TYPE_NORMAL:this.updateMissile();break;case MISSILE_TYPE_TORPEDO:this.updateTorpedo()}};this._init(a,g)}
function CTremble(a,g,b,e){var d,c,f,h,k,l,m;this._init=function(p,q,r,t){h=f=!1;l=0;this._calculateDuration();d=p.x;c=p.y;f||(f=!0,k=setInterval(function(){n._tremble()},r))};this._tremble=function(){if(h=!h){var p=.5>Math.random()?-e:e;var q=.5>Math.random()?-e:e;a.x+=p;a.y+=q}else a.x=d,a.y=c;l++;l>m&&(l=0,f=!1,0===g?k=setInterval(function(){n._tremble()},b):clearInterval(k))};this._calculateDuration=function(){m=g/b};this.stopTremble=function(){clearInterval(k)};var n=this;this._init(a,g,b,e)}
function CVector2(a,g){var b,e;this._init=function(d,c){b=d;e=c};this.add=function(d,c){b+=d;e+=c};this.addV=function(d){b+=d.getX();e+=d.getY()};this.scalarDivision=function(d){b/=d;e/=d};this.subV=function(d){b-=d.getX();e-=d.getY()};this.scalarProduct=function(d){b*=d;e*=d};this.invert=function(){b*=-1;e*=-1};this.dotProduct=function(d){return b*d.getX()+e*d.getY()};this.set=function(d,c){b=d;e=c};this.setV=function(d){b=d.getX();e=d.getY()};this.length=function(){return Math.sqrt(b*b+e*e)};this.length2=
function(){return b*b+e*e};this.normalize=function(){var d=this.length();0<d&&(b/=d,e/=d)};this.getNormalize=function(d){this.length();d.set(b,e);d.normalize()};this.rot90CCW=function(){var d=b;b=-e;e=d};this.rot90CW=function(){var d=b;b=e;e=-d};this.getRotCCW=function(d){d.set(b,e);d.rot90CCW()};this.getRotCW=function(d){d.set(b,e);d.rot90CW()};this.ceil=function(){b=Math.ceil(b);e=Math.ceil(e)};this.round=function(){b=Math.round(b);e=Math.round(e)};this.toString=function(){return"Vector2: "+b+", "+
e};this.print=function(){trace("Vector2: "+b+", "+e)};this.getX=function(){return b};this.getY=function(){return e};this._init(a,g)}
function CBackground(a){var g,b,e;this._init=function(d){e=new createjs.Container;d.addChild(e);if(s_bMobile)d=s_oSpriteLibrary.getSprite("sea_mobile"),d=createBitmap(d),e.addChild(d);else{var c=d=g=0;b=[];for(var f=0;32>=f;f++)b.push(new CSeaAnimation(d,c,e)),d+=SEA_PIECE_DIM/2,0===f%8&&0<f&&(c+=SEA_PIECE_DIM/2,d=0)}d=s_oSpriteLibrary.getSprite("bg_rocks");d=createBitmap(d);e.addChild(d)};this.update=function(){g++;if(1<g)for(var d=g=0;d<b.length;d++)b[d].update()};this._init(a)}
function CSeaAnimation(a,g,b){var e,d,c,f;this._init=function(h,k,l){f=new createjs.Container;f.x=h;f.y=k;f.scaleX=f.scaleY=.5;l.addChild(f);d=37;e=Math.floor(Math.random()*d);c=[];for(h=0;h<=d;h++)k=s_oSpriteLibrary.getSprite("surface_"+h),c[h]=createBitmap(k),c[h].visible=!1,f.addChild(c[h]);c[0].visible=!0};this._idle=function(){0===e?(c[d].visible=!1,c[0].visible=!0):(c[e-1].visible=!1,c[e].visible=!0);e++;e>d&&(e=0)};this.update=function(){this._idle()};this._init(a,g,b)}
function CSummaryPanel(a,g,b){var e,d,c,f,h,k,l,m;this._init=function(n,p,q){f=new createjs.Container;this.setPos(n,p);q.addChild(f);q=s_oSpriteLibrary.getSprite("your_fleet_panel");h=createBitmap(q);h.regY=q.height;f.addChild(h);var r=290,t=30;n=q.width/2;p=-q.height+22;new CTLText(f,n-r/2,p-t/2,r,t,30,"center","#04b700",SECONDARY_FONT,1,2,2,TEXT_YOUR_FLEET,!0,!0,!1,!1);var u=s_oSpriteLibrary.getSprite("enemy_fleet_panel");k=createBitmap(u);k.x=q.width;k.regY=u.height;f.addChild(k);r=240;t=30;n=
q.width+130;p=-u.height+18;new CTLText(f,n-r/2,p-t/2,r,t,30,"center","#b81e00",SECONDARY_FONT,1,2,2,TEXT_ENEMY_FLEET,!0,!0,!1,!1);n=s_oSpriteLibrary.getSprite("score_panel");l=createBitmap(n);l.x=2*q.width-50;l.y=-u.height+1;f.addChild(l);r=340;t=30;n=l.x+180;p=l.y+18;m=new CTLText(f,n-r/2,p-t/2,r,t,30,"left","#04b700",SECONDARY_FONT,1,2,2,sprintf(TEXT_SCORE,0),!0,!0,!1,!1);this.setYourFill();this.setText()};this.setYourFill=function(){e=[];for(var n=0;6>n;n++){var p=s_oSpriteLibrary.getSprite("fill_"+
n),q=createBitmap(p);q.regX=p.width/2;q.regY=p.height/2;q.x=SHIPS_TYPE[n].fill_pos.x;q.y=SHIPS_TYPE[n].fill_pos.y;f.addChild(q);e[n]=new createjs.Shape;e[n].graphics.beginFill("rgba(255,255,255,0.01)").drawRect(0,0,p.width,p.height);e[n].x=SHIPS_TYPE[n].fill_pos.x-p.width/2;e[n].y=SHIPS_TYPE[n].fill_pos.y-p.height/2;f.addChild(e[n]);q.mask=e[n];e[n].scaleX=0}};this.setText=function(){d=[];for(var n=0;6>n;n++)d[n]=new createjs.Text(TEXT_SUNK," 30px "+SECONDARY_FONT,"#ff7200"),d[n].x=SHIPS_TYPE[n].fill_pos.x,
d[n].y=SHIPS_TYPE[n].fill_pos.y+10,d[n].textAlign="center",d[n].textBaseline="middle",d[n].lineWidth=200,d[n].visible=!1,d[n].rotation=15,f.addChild(d[n]);c=[];for(n=0;6>n;n++)c[n]=new createjs.Text(TEXT_SUNK," 30px "+SECONDARY_FONT,"#ff7200"),c[n].x=SHIPS_TYPE[n].enemy_sunk_pos.x,c[n].y=SHIPS_TYPE[n].enemy_sunk_pos.y,c[n].textAlign="center",c[n].textBaseline="middle",c[n].lineWidth=200,c[n].rotation=15,c[n].visible=!1,f.addChild(c[n])};this.setDamage=function(n){for(var p=0;p<n.length;p++){for(var q=
n[p].getType(),r=n[p].getListCellOccupied(),t=r.length,u=0,F=0;F<t;F++)r[F].hit&&u++;e[q.battle_spritesheet].scaleX=u/t;u===t&&(d[q.battle_spritesheet].visible=!0)}};this.setEnemySunk=function(n){for(var p=0;p<n.length;p++){for(var q=n[p].getType(),r=n[p].getListCellOccupied(),t=r.length,u=0,F=0;F<t;F++)r[F].hit&&u++;u===t&&(c[q.battle_spritesheet].visible=!0)}};this.setScore=function(n){m.refreshText(sprintf(TEXT_SCORE,n))};this.setPos=function(n,p){f.x=n;f.y=p};this._init(a,g,b)}
function CAnimatedButton(a,g,b,e){var d,c,f,h,k,l,m,n;this._init=function(p,q,r,t){d=!1;c=1;l=[];m=[];n=createSprite(r,"disable",60,60,120,120);n.x=p;n.y=q;n.scaleX=n.scaleY=c;t.addChild(n);this._initListener()};this.unload=function(){s_bMobile?n.off("mousedown",f):(n.off("mousedown",f),n.off("mouseover",k),n.off("mouseout",_iListenerIDMouseOut));n.off("pressup",h);e.removeChild(n)};this.setVisible=function(p){n.visible=p};this.setClickable=function(p){d=!p};this._initListener=function(){s_bMobile?
f=n.on("mousedown",this.buttonDown):(f=n.on("mousedown",this.buttonDown),k=n.on("mouseover",this.buttonOver),_iListenerIDMouseOut=n.on("mouseout",this.buttonOut));h=n.on("pressup",this.buttonRelease)};this.addEventListener=function(p,q,r){l[p]=q;m[p]=r};this.buttonRelease=function(){d||(n.scaleX=c,n.scaleY=c,l[ON_MOUSE_UP]&&l[ON_MOUSE_UP].call(m[ON_MOUSE_UP]))};this.buttonDown=function(){d||(n.scaleX=.9*c,n.scaleY=.9*c,playSound("click",1,!1),l[ON_MOUSE_DOWN]&&l[ON_MOUSE_DOWN].call(m[ON_MOUSE_DOWN]))};
this.buttonOver=function(p){s_bMobile||d||(p.target.cursor="pointer",l[ON_MOUSE_OVER]&&l[ON_MOUSE_OVER].call(m[ON_MOUSE_OVER]))};this.buttonOut=function(p){s_bMobile||d||(p.target.cursor="pointer",l[ON_MOUSE_OUT]&&l[ON_MOUSE_OUT].call(m[ON_MOUSE_OUT]))};this.pulseAnimation=function(){createjs.Tween.get(n,{loop:!0}).to({scaleX:.9*c,scaleY:.9*c},850,createjs.Ease.quadOut).to({scaleX:c,scaleY:c},650,createjs.Ease.quadIn)};this.trembleAnimation=function(){createjs.Tween.get(n,{loop:!0}).to({rotation:5},
75,createjs.Ease.quadOut).to({rotation:-5},140,createjs.Ease.quadIn).to({rotation:0},75,createjs.Ease.quadIn).wait(750)};this.setPosition=function(p,q){n.x=p;n.y=q};this.getPos=function(){return{x:n.x,y:n.y}};this.setX=function(p){n.x=p};this.setY=function(p){n.y=p};this.getButtonImage=function(){return n};this.getX=function(){return n.x};this.getY=function(){return n.y};this.enable=function(p){p?(n.gotoAndPlay("idle"),this.setClickable(!0)):(n.gotoAndPlay("disable"),this.setClickable(!1))};this._init(a,
g,b,e);return this}
CTLText.prototype={constructor:CTLText,__autofit:function(){if(this._bFitText){for(var a=this._iFontSize;(this._oText.getBounds().height>this._iHeight-2*this._iPaddingV||this._oText.getBounds().width>this._iWidth-2*this._iPaddingH)&&!(a--,this._oText.font=a+"px "+this._szFont,this._oText.lineHeight=Math.round(a*this._fLineHeightFactor),this.__updateY(),this.__verticalAlign(),8>a););this._iFontSize=a}},__verticalAlign:function(){if(this._bVerticalAlign){var a=this._oText.getBounds().height;this._oText.y-=
(a-this._iHeight)/2+this._iPaddingV}},__updateY:function(){this._oText.y=this._y+this._iPaddingV;switch(this._oText.textBaseline){case "middle":this._oText.y+=this._oText.lineHeight/2+(this._iFontSize*this._fLineHeightFactor-this._iFontSize)}},__createText:function(a){this._bDebug&&(this._oDebugShape=new createjs.Shape,this._oDebugShape.graphics.beginFill("rgba(255,0,0,0.5)").drawRect(this._x,this._y,this._iWidth,this._iHeight),this._oContainer.addChild(this._oDebugShape));this._oText=new createjs.Text(a,
this._iFontSize+"px "+this._szFont,this._szColor);this._oText.textBaseline="middle";this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this._oText.textAlign=this._szAlign;this._oText.lineWidth=this._bMultiline?this._iWidth-2*this._iPaddingH:null;switch(this._szAlign){case "center":this._oText.x=this._x+this._iWidth/2;break;case "left":this._oText.x=this._x+this._iPaddingH;break;case "right":this._oText.x=this._x+this._iWidth-this._iPaddingH}this._oContainer.addChild(this._oText);
this.refreshText(a)},setVerticalAlign:function(a){this._bVerticalAlign=a},setOutline:function(a){null!==this._oText&&(this._oText.outline=a)},setShadow:function(a,g,b,e){null!==this._oText&&(this._oText.shadow=new createjs.Shadow(a,g,b,e))},setColor:function(a){this._oText.color=a},setAlpha:function(a){this._oText.alpha=a},setVisible:function(a){this._oText.visible=a},setX:function(a){this._x=this._oText.x=a},setY:function(a){this._y=this._oText.y=a},removeTweens:function(){createjs.Tween.removeTweens(this._oText)},
getText:function(){return this._oText},getX:function(){return this._x},getY:function(){return this._y},getFontSize:function(){return this._iFontSize},refreshText:function(a){""===a&&(a=" ");null===this._oText&&this.__createText(a);this._oText.text=a;this._oText.font=this._iFontSize+"px "+this._szFont;this._oText.lineHeight=Math.round(this._iFontSize*this._fLineHeightFactor);this.__autofit();this.__updateY();this.__verticalAlign()}};
function CTLText(a,g,b,e,d,c,f,h,k,l,m,n,p,q,r,t,u){this._oContainer=a;this._x=g;this._y=b;this._iWidth=e;this._iHeight=d;this._bMultiline=t;this._iFontSize=c;this._szAlign=f;this._szColor=h;this._szFont=k;this._iPaddingH=m;this._iPaddingV=n;this._bVerticalAlign=r;this._bFitText=q;this._bDebug=u;this._oDebugShape=null;this._fLineHeightFactor=l;this._oText=null;p&&this.__createText(p)}
!function(){function a(d){var c=d;if(e[c])c=e[c];else{for(var f=c,h,k=[],l=0;f;){if(null!==(h=b.text.exec(f)))k.push(h[0]);else if(null!==(h=b.modulo.exec(f)))k.push("%");else if(null!==(h=b.placeholder.exec(f))){if(h[2]){l|=1;var m=[],n=h[2],p;if(null!==(p=b.key.exec(n)))for(m.push(p[1]);""!==(n=n.substring(p[0].length));)if(null!==(p=b.key_access.exec(n)))m.push(p[1]);else if(null!==(p=b.index_access.exec(n)))m.push(p[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key");
else throw new SyntaxError("[sprintf] failed to parse named argument key");h[2]=m}else l|=2;if(3===l)throw Error("[sprintf] mixing positional and named placeholders is not (yet) supported");k.push({placeholder:h[0],param_no:h[1],keys:h[2],sign:h[3],pad_char:h[4],align:h[5],width:h[6],precision:h[7],type:h[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");f=f.substring(h[0].length)}c=e[c]=k}f=arguments;h=1;k=c.length;m="";var q,r;for(n=0;n<k;n++)if("string"===typeof c[n])m+=c[n];
else if("object"===typeof c[n]){p=c[n];if(p.keys)for(l=f[h],q=0;q<p.keys.length;q++){if(void 0==l)throw Error(a('[sprintf] Cannot access property "%s" of undefined value "%s"',p.keys[q],p.keys[q-1]));l=l[p.keys[q]]}else l=p.param_no?f[p.param_no]:f[h++];b.not_type.test(p.type)&&b.not_primitive.test(p.type)&&l instanceof Function&&(l=l());if(b.numeric_arg.test(p.type)&&"number"!==typeof l&&isNaN(l))throw new TypeError(a("[sprintf] expecting number but found %T",l));b.number.test(p.type)&&(r=0<=l);
switch(p.type){case "b":l=parseInt(l,10).toString(2);break;case "c":l=String.fromCharCode(parseInt(l,10));break;case "d":case "i":l=parseInt(l,10);break;case "j":l=JSON.stringify(l,null,p.width?parseInt(p.width):0);break;case "e":l=p.precision?parseFloat(l).toExponential(p.precision):parseFloat(l).toExponential();break;case "f":l=p.precision?parseFloat(l).toFixed(p.precision):parseFloat(l);break;case "g":l=p.precision?String(Number(l.toPrecision(p.precision))):parseFloat(l);break;case "o":l=(parseInt(l,
10)>>>0).toString(8);break;case "s":l=String(l);l=p.precision?l.substring(0,p.precision):l;break;case "t":l=String(!!l);l=p.precision?l.substring(0,p.precision):l;break;case "T":l=Object.prototype.toString.call(l).slice(8,-1).toLowerCase();l=p.precision?l.substring(0,p.precision):l;break;case "u":l=parseInt(l,10)>>>0;break;case "v":l=l.valueOf();l=p.precision?l.substring(0,p.precision):l;break;case "x":l=(parseInt(l,10)>>>0).toString(16);break;case "X":l=(parseInt(l,10)>>>0).toString(16).toUpperCase()}if(b.json.test(p.type))m+=
l;else{if(!b.number.test(p.type)||r&&!p.sign)var t="";else t=r?"+":"-",l=l.toString().replace(b.sign,"");q=p.pad_char?"0"===p.pad_char?"0":p.pad_char.charAt(1):" ";var u=p.width-(t+l).length;u=p.width?0<u?q.repeat(u):"":"";m+=p.align?t+l+u:"0"===q?t+u+l:u+t+l}}return m}function g(d,c){return a.apply(null,[d].concat(c||[]))}var b={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,
placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/},e=Object.create(null);"undefined"!==typeof exports&&(exports.sprintf=a,exports.vsprintf=g);"undefined"!==typeof window&&(window.sprintf=a,window.vsprintf=g,"function"===typeof define&&define.amd&&define(function(){return{sprintf:a,vsprintf:g}}))}();